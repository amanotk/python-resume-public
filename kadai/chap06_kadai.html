<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>第6章 演習課題 &mdash; Python演習(地球惑星物理学演習)</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Python演習
          </a>
              <div class="version">
                2023
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../chap01.html">1. はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap02.html">2. Pythonの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap03.html">3. 対話型の実行方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap04.html">4. 制御構造と関数・オブジェクト</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap05.html">5. 便利な組み込み型</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap06.html">6. NumPy配列の基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap07.html">7. スクリプトとしてのPython</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Python演習</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">第6章 演習課題</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>第6章 演習課題<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>以下の課題はJupyter Notebookの使用を前提としているが，もちろん他の実行環境でも同等の処理を実現出来ていれば問題ない．ただし，この章の目的はNumPy配列の使い方の習得なので，以下の課題では <strong>可能な限りループを使わず</strong> NumPyの機能を活かした実装を目指そう．</p>
<p>なお，以下では</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
<p>のように必要なモジュールが <code class="docutils literal notranslate"><span class="pre">import</span></code> されているものとする．</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p><a class="reference external" href="sample/chap06/kadai.html">解答例</a> (<a class="reference external" href="sample/chap06/kadai.ipynb">ダウンロード</a>)</p>
</div>
<section id="id4">
<h2>課題1<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h2>
<p>サンプルを実行して動作を確認せよ．</p>
</section>
<section id="id5">
<h2>課題2<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h2>
<p>整数 <code class="docutils literal notranslate"><span class="pre">N</span></code> を引数として受け取り， <span class="math notranslate nohighlight">\(0^{\circ} \leq \theta \leq 180^{\circ}\)</span> をN分割した点(端点を含むのでN+1点)，およびそれらの点における <span class="math notranslate nohighlight">\(\sin \theta\)</span> ， <span class="math notranslate nohighlight">\(\cos \theta\)</span> の値をそれぞれ配列として返す関数</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">trigonometric</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="s2">&quot;θ, sinθ, cosθの値を出力する&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成せよ．これを呼び出し，例えば以下のようにプロットして結果を確認しよう．</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">trigonometric</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id19">
<img alt="kadai/figure/chap06_trigonometric.png" src="kadai/figure/chap06_trigonometric.png" />
<figcaption>
<p><span class="caption-text">課題2</span><a class="headerlink" href="#id19" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id6">
<h2>課題3<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h2>
<p>以下の級数展開</p>
<div class="math notranslate nohighlight">
\[e \simeq \sum_{n=0}^{N} \frac{1}{n !}. \quad (0! = 1に注意せよ)\]</div>
<p>により自然対数の底 <span class="math notranslate nohighlight">\(e\)</span> の近似値を求める関数 <code class="docutils literal notranslate"><span class="pre">approx_e()</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">approx_e</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="s2">&quot;自然対数の底を級数展開を用いて求める&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．ただし整数 <code class="docutils literal notranslate"><span class="pre">N</span></code> を引数として受け取り，内部ではNumPy配列を使うことでループを用いない実装とせよ．</p>
<p>ここで，階乗とガンマ関数の関係式</p>
<div class="math notranslate nohighlight">
\[\Gamma(n) = (n-1)!\]</div>
<p>を用いてよい．ガンマ関数は <code class="docutils literal notranslate"><span class="pre">scipy.special.gamma()</span></code> を用いればよい．以下はその使用例である．</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">special</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># 2!</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># 3!</span>
<span class="go">6.0</span>
</pre></div>
</div>
<p>この関数を用いると例えば以下のような結果が得られる．</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&gt;20.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Approximated&#39;</span><span class="p">,</span> <span class="n">approx_e</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&gt;20.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Exact&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="p">))</span>
<span class="go">Approximated         : 2.71828152557319e+00</span>
<span class="go">Exact                : 2.71828182845905e+00</span>
</pre></div>
</div>
</section>
<section id="id7">
<h2>課題4<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h2>
<p>以下の漸化式</p>
<div class="math notranslate nohighlight">
\[p_{n+1} = p_n + \alpha p_n (1 - p_n)\]</div>
<p>で定義される数列 <span class="math notranslate nohighlight">\(p_n (n=0, 1, \ldots)\)</span> を考える．<span class="math notranslate nohighlight">\(1 &lt; \alpha &lt; 3\)</span> を <span class="math notranslate nohighlight">\(m\)</span> 分割し，各 <span class="math notranslate nohighlight">\(\alpha\)</span> について初期値 <span class="math notranslate nohighlight">\(p_0 = 0.9\)</span> から数列を生成し，そのうち <span class="math notranslate nohighlight">\(n=100, \ldots, 200\)</span> を <span class="math notranslate nohighlight">\(\alpha\)</span> の関数としてプロットしよう．</p>
<p>これには，整数 <code class="docutils literal notranslate"><span class="pre">m</span></code> を引数にとり，<span class="math notranslate nohighlight">\(\alpha\)</span> と <span class="math notranslate nohighlight">\(p_n (n=100, \ldots, 200)\)</span> の組を返す関数 <code class="docutils literal notranslate"><span class="pre">logistic()</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">logistic</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="s2">&quot;0 &lt; α &lt; 1 をm分割して，それぞれに対してロジスティック写像を計算&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成し，この関数を用いて</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">logistic</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">)</span>
</pre></div>
</div>
<p>とすればよい．結果は以下の通りである．</p>
<figure class="align-center" id="id20">
<img alt="kadai/figure/chap06_logistic.png" src="kadai/figure/chap06_logistic.png" />
<figcaption>
<p><span class="caption-text">課題4</span><a class="headerlink" href="#id20" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>このような写像はロジスティック写像と呼ばれ，非常に単純な式ながら一定の条件を満たすときにはカオスを生み出すことが知られている．</p>
</section>
<section id="id8">
<h2>課題5<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h2>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p>アルゴリズムについては <a class="reference external" href="https://amanotk.github.io/fortran-resume-public/chap08.html#c8-numerical-integration">こちら</a> を参照．</p>
</div>
<p>以下の積分</p>
<div class="math notranslate nohighlight">
\[\int_{0}^{1} \frac{4}{\pi} \frac{1}{1 + x^2} dx\]</div>
<p>を台形公式およびSimpsonの公式を使って求める関数をそれぞれ作成しよう．ここで作成する関数は分割数 <code class="docutils literal notranslate"><span class="pre">n</span></code> を引数にとり，</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">trapezoid</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="s2">&quot;分割数nの台形公式で関数を積分&quot;</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">simpson</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="s2">&quot;分割数nのSimpson公式で関数を積分&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>のような形になるものとする．ただし関数内ではループを使わずに実装すること．これらの積分公式の誤差の分割数依存性は次のようにすれば調べることができる．</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="mi">16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">err1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">err2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">err1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">err2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simpson</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 結果をプロット</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">err1</span><span class="p">,</span> <span class="s1">&#39;rx-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;trapezoid&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">err2</span><span class="p">,</span> <span class="s1">&#39;bx-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;simpson&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>これによって得られる図は以下の通りである．</p>
<figure class="align-center" id="id21">
<img alt="kadai/figure/chap06_integration.png" src="kadai/figure/chap06_integration.png" />
<figcaption>
<p><span class="caption-text">課題5</span><a class="headerlink" href="#id21" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id10">
<h2>課題6<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h2>
<p>データファイルに格納されている学生のテスト点数リストから，最高点，最大点，平均点，標準偏差を求めて返す関数 <code class="docutils literal notranslate"><span class="pre">analyze_score()</span></code> を作成しよう．ただし，</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analyze_score</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="s2">&quot;filenameからデータを読んで最高点，最低点，平均点，標準偏差を返す&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>のようにファイル名を引数にとるものとする．ここで，それぞれ対応する関数( <code class="docutils literal notranslate"><span class="pre">np.max()</span></code> ， <code class="docutils literal notranslate"><span class="pre">np.min()</span></code> ， <code class="docutils literal notranslate"><span class="pre">np.mean()</span></code> ， <code class="docutils literal notranslate"><span class="pre">np.std()</span></code> )またはNumPy配列のメソッドを用いること．</p>
<p>なお，データファイルは <a class="reference external" href="sample/chap06/score1.dat">score1.dat</a> および <a class="reference external" href="sample/chap06/score2.dat">score2.dat</a> とし，以下のようにこのファイルの最初の行にはデータ数，次の行は空行，以降に実際のデータが格納されている．</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ cat score1.dat
<span class="m">30</span>      <span class="c1"># データ数</span>
        <span class="c1"># 空白行</span>
<span class="m">20</span>      <span class="c1"># 実際のデータはこれ以降の行</span>
<span class="m">49</span>
<span class="m">45</span>
<span class="o">(</span>以下略）
</pre></div>
</div>
<p>したがって， <code class="docutils literal notranslate"><span class="pre">np.loadtxt()</span></code> のオプション <code class="docutils literal notranslate"><span class="pre">skiprows</span></code> を用いて最初の2行を無視して読み込めばよい．</p>
<p>例えばscore1.datを読み込んだ場合には以下のような結果が得られる．</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smax</span><span class="p">,</span> <span class="n">smin</span><span class="p">,</span> <span class="n">savg</span><span class="p">,</span> <span class="n">sstd</span> <span class="o">=</span> <span class="n">analyze_score</span><span class="p">(</span><span class="s1">&#39;score1.dat&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:10}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Best&#39;</span><span class="p">,</span> <span class="n">smax</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:10}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Worst&#39;</span><span class="p">,</span> <span class="n">smin</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:10.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">savg</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:10.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Standard deviation&#39;</span><span class="p">,</span> <span class="n">sstd</span><span class="p">))</span>
<span class="go">Best                 :         98</span>
<span class="go">Worst                :          6</span>
<span class="go">Average              :     46.400</span>
<span class="go">Standard deviation   :     25.115</span>
</pre></div>
</div>
<p>同様にscore2.datについても試してみること．</p>
</section>
<section id="id11">
<h2>課題7<a class="headerlink" href="#id11" title="Permalink to this heading"></a></h2>
<p>前問のscore1.datおよびscore2.datのようなデータファイルを読み込みヒストグラムを作成する関数 <code class="docutils literal notranslate"><span class="pre">hist_score()</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hist_score</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">nbin</span><span class="p">):</span>
    <span class="s2">&quot;filenameからデータを読んでヒストグラムを作成する&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．ここで引数 <code class="docutils literal notranslate"><span class="pre">nbin</span></code> はビンの数である．関数 <code class="docutils literal notranslate"><span class="pre">np.histogram()</span></code> を用いること．</p>
<p>実行例は以下のようになる．</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nbin</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span><span class="p">,</span> <span class="n">hist</span> <span class="o">=</span> <span class="n">hist_score</span><span class="p">(</span><span class="s1">&#39;score2.dat&#39;</span><span class="p">,</span> <span class="n">nbin</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binw</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">hist</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">binw</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;edge&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id22">
<img alt="kadai/figure/chap06_score.png" src="kadai/figure/chap06_score.png" />
<figcaption>
<p><span class="caption-text">課題7</span><a class="headerlink" href="#id22" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id12">
<h2>課題8<a class="headerlink" href="#id12" title="Permalink to this heading"></a></h2>
<p>データファイル <a class="reference external" href="sample/chap06/vector.dat">vector.dat</a> に格納されている2つのベクトルを読み込み，それらの内積を求める関数 <code class="docutils literal notranslate"><span class="pre">dot_file()</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dot_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="s2">&quot;filenameから2つのベクトルを読み込み，それらの内積を返す&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．関数 <code class="docutils literal notranslate"><span class="pre">np.dot()</span></code> を用いること．ただし，以下のようにvector.datの最初の行にはベクトルの長さ，次の行は空白，ベクトル1の各要素，空白行，ベクトル2の各要素，のようにデータが格納されている．</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">20</span>                      <span class="c1"># データ数</span>
                        <span class="c1"># 空白行</span>
<span class="m">1</span>.000000000000000e+00
<span class="m">9</span>.510565162951535e-01
<span class="o">(</span>中略<span class="o">)</span>
<span class="m">8</span>.090169943749473e-01
<span class="m">9</span>.510565162951535e-01
                        <span class="c1"># 空白行</span>
<span class="m">0</span>.000000000000000e+00
<span class="m">3</span>.090169943749474e-01
<span class="o">(</span>中略<span class="o">)</span>
-5.877852522924734e-01
-3.090169943749476e-01
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">np.loadtxt()</span></code> のオプション <code class="docutils literal notranslate"><span class="pre">skiprows</span></code> を用いて最初の2行を無視して読み込むと以降のデータが全て1次元配列として返される(区切りの空白行は無視される)ので，この前半と後半をそれぞれ別のベクトルとして処理すればよい．</p>
</section>
<section id="id13">
<h2>課題9<a class="headerlink" href="#id13" title="Permalink to this heading"></a></h2>
<p>任意の長さの1次元整数型配列に与えられた整数が含まれているかどうかを調べ，含まれていた時には真 ( <code class="docutils literal notranslate"><span class="pre">True</span></code> ，そうでなければ偽 <code class="docutils literal notranslate"><span class="pre">False</span></code> )を返す関数 <code class="docutils literal notranslate"><span class="pre">find_var</span></code> を作成しよう．また同様に，値が含まれていた時にはその要素のインデックスを返し，そうでなければ-1を返す関数 <code class="docutils literal notranslate"><span class="pre">find_var_index()</span></code> を作成しよう．実装は色々考えられるが， <code class="docutils literal notranslate"><span class="pre">np.any()</span></code> や <code class="docutils literal notranslate"><span class="pre">np.nonzero()</span></code> または <code class="docutils literal notranslate"><span class="pre">np.where()</span></code> などを使うとよい．</p>
<p>これらの関数を</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
    <span class="s2">&quot;varが配列xに含まれているかどうかを調べる&quot;</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">find_var_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
    <span class="s2">&quot;varが配列xに含まれている時にはそのインデックスを，そうでない場合は-1を返す&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>のように定義し，以下のように動作を確かめよう．</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">array([17, 75, 28, 83, 93, 20, 19, 94, 62, 61])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_var_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_var_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>さらに， <code class="docutils literal notranslate"><span class="pre">np.random.randint()</span></code> を用いて適当な長さの1次元整数配列を作成し，値を探索してみよう．</p>
</section>
<section id="id14">
<h2>課題10<a class="headerlink" href="#id14" title="Permalink to this heading"></a></h2>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p>1次元のセル・オートマトンについては <a class="reference external" href="https://ja.wikipedia.org/wiki/%E3%82%BB%E3%83%AB%E3%83%BB%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%83%88%E3%83%B3#1%E6%AC%A1%E5%85%83%E3%82%BB%E3%83%AB%E3%83%BB%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%83%88%E3%83%B3">Wikipedia</a> を参照．</p>
</div>
<p>1次元のセル・オートマトンを実装しよう．具体的には，以下のような関数を作成し，10進数で与えられたルール <code class="docutils literal notranslate"><span class="pre">decrule</span></code> に基づいて，一次元配列 <code class="docutils literal notranslate"><span class="pre">x</span></code> を初期値とし， <code class="docutils literal notranslate"><span class="pre">step</span></code> 数だけ状態遷移を求めよう．関数の返値は2次元配列で，各ステップ，各セルの状態を表すものとする．ただし，境界の値は初期値のまま固定でよい．</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cellular_automaton</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">decrule</span><span class="p">):</span>
    <span class="s2">&quot;初期値xからstep数だけセル・オートマトンによる状態遷移を求める&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>例えば以下の例ではルール90を採用し，初期値として中央のセルのみを1とし，それ以外は0を与えている．</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">256</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xzero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xzero</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">cellular_automaton</span><span class="p">(</span><span class="n">xzero</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray_r</span><span class="p">)</span>
</pre></div>
</div>
<p>これはシェルピンスキーのギャスケット（下図）を生成することが知られている．</p>
<figure class="align-center" id="id23">
<img alt="kadai/figure/chap06_rule90.png" src="kadai/figure/chap06_rule90.png" />
<figcaption>
<p><span class="caption-text">課題10</span><a class="headerlink" href="#id23" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id15">
<h2>課題11<a class="headerlink" href="#id15" title="Permalink to this heading"></a></h2>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p>アルゴリズムについては <a class="reference external" href="https://amanotk.github.io/fortran-resume-public/chap08.html#id18">こちら</a> を参照．</p>
</div>
<p>逆関数法を使って指数分布</p>
<div class="math notranslate nohighlight">
\[P(x) = \lambda \exp ( - \lambda x )\]</div>
<p>に従う乱数を返す関数 <code class="docutils literal notranslate"><span class="pre">randexp()</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">randexp</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="s2">&quot;指数分布に従う乱数をn個作成する&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．(ただし，実用上は指数分布に従う乱数は <code class="docutils literal notranslate"><span class="pre">numpy.random.exponential()</span></code> によって得られるので，これを用いればよい．）</p>
<p>この関数を用いて発生させた乱数と解析的な確率分布を以下のように比較しよう．</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">randexp</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">60000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ヒストグラム</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">hist</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 解析的な分布</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">l</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">l</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">()</span>
</pre></div>
</div>
<p>この結果は以下のようになる．</p>
<figure class="align-center" id="id24">
<img alt="kadai/figure/chap06_exponential.png" src="kadai/figure/chap06_exponential.png" />
<figcaption>
<p><span class="caption-text">課題11</span><a class="headerlink" href="#id24" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id17">
<h2>課題12<a class="headerlink" href="#id17" title="Permalink to this heading"></a></h2>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p>アルゴリズムについては <a class="reference external" href="https://amanotk.github.io/fortran-resume-public/chap08.html#id19">こちら</a> を参照．</p>
</div>
<p>モンテカルロ法を用いてN次元超球の体積を求める関数 <code class="docutils literal notranslate"><span class="pre">mc_hypersphere()</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mc_hypersphere</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nrand</span><span class="p">):</span>
    <span class="s2">&quot;n次元超球の体積をモンテカルロ法で求める&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．ここで <code class="docutils literal notranslate"><span class="pre">nrand</span></code> は各次元について発生させる乱数の個数である．</p>
<p>この関数を使って近似値と解析的な値を以下のように比較しよう．</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nrand</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&lt;20.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Monte-Carlo&#39;</span><span class="p">,</span> <span class="n">mc_hypersphere</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nrand</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&lt;20.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Exact&#39;</span><span class="p">,</span> <span class="n">hypersphere</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
<span class="go">Monte-Carlo          : 4.18304000000000e+00</span>
<span class="go">Exact                : 4.18879020478639e+00</span>
</pre></div>
</div>
<p>ただし，解析的な値を返す関数 <code class="docutils literal notranslate"><span class="pre">hypersphere()</span></code> を別途定義するものとする．</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Takanobu Amano.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>