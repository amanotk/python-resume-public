<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>6. NumPy配列の基本 &mdash; Python演習(地球惑星物理学演習)</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="7. スクリプトとしてのPython" href="chap07.html" />
    <link rel="prev" title="5. 便利な組み込み型" href="chap05.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Python演習
          </a>
              <div class="version">
                2023
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="chap01.html">1. はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap02.html">2. Pythonの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap03.html">3. 対話型の実行方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap04.html">4. 制御構造と関数・オブジェクト</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap05.html">5. 便利な組み込み型</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. NumPy配列の基本</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">6.1. NumPyについて</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">6.2. 基本的な使い方</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id9">6.3. 配列オブジェクト</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id10">6.3.1. 属性</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">6.3.2. データ型</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id12">6.4. 生成</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id13">6.4.1. シーケンス型からの生成</a></li>
<li class="toctree-l3"><a class="reference internal" href="#arange">6.4.2. arange</a></li>
<li class="toctree-l3"><a class="reference internal" href="#zeros">6.4.3. zeros</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ones">6.4.4. ones</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linspace">6.4.5. linspace</a></li>
<li class="toctree-l3"><a class="reference internal" href="#geomspace-logspace">6.4.6. geomspace / logspace</a></li>
<li class="toctree-l3"><a class="reference internal" href="#random">6.4.7. random</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id14">6.5. 入出力</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id15">6.5.1. テキスト入出力</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#loadtxt">6.5.1.1. loadtxt</a></li>
<li class="toctree-l4"><a class="reference internal" href="#savetxt">6.5.1.2. savetxt</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id17">6.5.2. バイナリ入出力</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#npynpz">6.5.2.1. NPY形式とNPZ形式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19">6.5.2.2. 生のバイナリファイル</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unformatted-fortran">6.5.2.3. unformatted形式(Fortran)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hdf5netcdf">6.5.2.4. HDF5とnetCDF</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id22">6.6. 各種演算</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id23">6.6.1. 算術演算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id24">6.6.2. ユニバーサル関数</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id27">6.6.3. メソッド</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id29">6.7. インデックス操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id32">6.8. 形状操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id34">6.9. 第6章 演習課題</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id35">6.9.1. 課題1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id36">6.9.2. 課題2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id37">6.9.3. 課題3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id38">6.9.4. 課題4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id39">6.9.5. 課題5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id41">6.9.6. 課題6</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id42">6.9.7. 課題7</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id43">6.9.8. 課題8</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id44">6.9.9. 課題9</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id45">6.9.10. 課題10</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id46">6.9.11. 課題11</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id48">6.9.12. 課題12</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chap07.html">7. スクリプトとしてのPython</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Python演習</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">6. </span>NumPy配列の基本</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="numpy">
<h1><a class="toc-backref" href="#id57" role="doc-backlink"><span class="section-number">6. </span>NumPy配列の基本</a><a class="headerlink" href="#numpy" title="Permalink to this heading"></a></h1>
<p>NumPyと呼ばれるライブラリの存在はPythonが広く科学技術計算に用いられるようになった最も大きな要因の一つであろう．ここでは科学技術計算で用いられる大規模データの効率的な扱いを可能にするNumPyの多次元配列オブジェクトについて学ぼう．なお，以降はこの多次元配列オブジェクトを便宜的にNumPy配列と呼ぶことにする．</p>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<a href="sample/chap06/sample.html"> サンプルコード </a>
<a href="https://colab.research.google.com/github/amanotk/python-resume-sample/blob/main/chap06/sample.ipynb" target="_blank">
<img src="https://colab.research.google.com/assets/colab-badge.svg" style="vertical-align: text-top;">
</a></div>
<nav class="contents" id="id1">
<p class="topic-title">この章の内容</p>
<ul class="simple">
<li><p><a class="reference internal" href="#numpy" id="id57">NumPy配列の基本</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id58">NumPyについて</a></p></li>
<li><p><a class="reference internal" href="#id6" id="id59">基本的な使い方</a></p></li>
<li><p><a class="reference internal" href="#id9" id="id60">配列オブジェクト</a></p></li>
<li><p><a class="reference internal" href="#id12" id="id61">生成</a></p></li>
<li><p><a class="reference internal" href="#id14" id="id62">入出力</a></p></li>
<li><p><a class="reference internal" href="#id22" id="id63">各種演算</a></p></li>
<li><p><a class="reference internal" href="#id29" id="id64">インデックス操作</a></p></li>
<li><p><a class="reference internal" href="#id32" id="id65">形状操作</a></p></li>
<li><p><a class="reference internal" href="#id34" id="id66">第6章 演習課題</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="id2">
<h2><a class="toc-backref" href="#id58" role="doc-backlink"><span class="section-number">6.1. </span>NumPyについて</a><a class="headerlink" href="#id2" title="Permalink to this heading"></a></h2>
<p><a class="reference external" href="https://numpy.org/">NumPy</a> はPythonによる科学技術計算の根幹をなすライブラリである <a class="footnote-reference brackets" href="#numpylib" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> ．このライブラリが提供する <code class="docutils literal notranslate"><span class="pre">numpy</span></code> というモジュールを使うためには</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>のようにするのが一般的である．これは <code class="docutils literal notranslate"><span class="pre">numpy</span></code> という名前のモジュールを <code class="docutils literal notranslate"><span class="pre">import</span></code> し， <code class="docutils literal notranslate"><span class="pre">np</span></code> という別名を付けることを意味する．別名は必ずしもつけなくてもいいし，その別名を <code class="docutils literal notranslate"><span class="pre">np</span></code> にする必然性は何もない．しかし，世の中のほとんどのコードがこの書き方を採用しているので，ここでも慣例に従っておこう．以降では常に <code class="docutils literal notranslate"><span class="pre">np</span></code> が <code class="docutils literal notranslate"><span class="pre">numpy</span></code> モジュールを意味するものとする．</p>
<p>NumPy配列(NumPyが提供する多次元配列オブジェクト)は正確には <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> オブジェクトである <a class="footnote-reference brackets" href="#np-ndarray" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>．一般にPythonはスクリプト言語に分類される動作の遅い言語であるが，NumPy配列を用いることで非常に高速な数値演算が可能となる．これはNumPy配列がCで実装されており，NumPy配列の演算は「うまく」使えばほとんどが内部的にはCのコードとして実行されるからである．詳細は以下で追々見ていくことにしよう．</p>
</section>
<section id="id6">
<h2><a class="toc-backref" href="#id59" role="doc-backlink"><span class="section-number">6.2. </span>基本的な使い方</a><a class="headerlink" href="#id6" title="Permalink to this heading"></a></h2>
<p>まずは基礎の基礎を抑えよう．例えば配列を作る最も簡単な方法の一つとして</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="linenos">2</span><span class="go">array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span>
</pre></div>
</div>
<p>のように <code class="docutils literal notranslate"><span class="pre">np.arange()</span></code> を使う方法がある．<code class="docutils literal notranslate"><span class="pre">np.arange()</span></code> の引数に配列の長さを指定することで連番の整数配列ができる．この例では10が指定されているので，長さ10の整数配列が生成されている．</p>
<p>次に <span class="math notranslate nohighlight">\(0 &lt; x &lt; 2\pi\)</span> の範囲を等間隔に <span class="math notranslate nohighlight">\(N\)</span> 分割し，その各点で <span class="math notranslate nohighlight">\(\cos(x)\)</span> を計算してみよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="n">N</span> <span class="o">*</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>ここで整数の変数 <code class="docutils literal notranslate"><span class="pre">N</span></code> が配列のサイズである．2行目で配列 <code class="docutils literal notranslate"><span class="pre">x</span></code> を生成し，3行目でその配列の各要素について <span class="math notranslate nohighlight">\(\cos(x)\)</span> の値を計算している．</p>
<p>ここで2行目では <code class="docutils literal notranslate"><span class="pre">np.arange()</span></code> で生成した配列に対してスカラー値の掛け算や割り算(整数 / 整数 = 実数に注意)を実行していることが分かるだろう( <code class="docutils literal notranslate"><span class="pre">np.pi</span></code> は <span class="math notranslate nohighlight">\(\pi\)</span> の値である)．このとき，配列の各要素に対して演算がそれぞれ実行される．同様に3行目では配列の各要素に対して <code class="docutils literal notranslate"><span class="pre">np.cos()</span></code> 関数を呼び出し，結果として生成される新しい配列を <code class="docutils literal notranslate"><span class="pre">y</span></code> に代入している．このような使い方は <strong>Fortranの配列演算の使い方と全く同じ</strong> である．CやPythonの組み込みの配列 <a class="footnote-reference brackets" href="#intrinsicarray" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> では当然このような書き方は許されないが，NumPy配列はあたかもFortranの配列のように使えるのである．</p>
<p>このようにループを使わずに配列演算を記述できると確かに非常に便利であるが，NumPy配列の本当の利点は単に簡便さではなく，その演算速度にある．例えば <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">np.cos(x)</span></code> を(長さ <code class="docutils literal notranslate"><span class="pre">N</span></code> の配列 <code class="docutils literal notranslate"><span class="pre">x</span></code> および <code class="docutils literal notranslate"><span class="pre">y</span></code> が定義されているとして)Pythonのループを使って書くならば，</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span>  <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
<p>のようになるだろう <a class="footnote-reference brackets" href="#numpymath" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> ．ここでNumPy配列の各要素へのアクセスにはCのように <code class="docutils literal notranslate"><span class="pre">[]</span></code> を使って行うことに注意しよう．計算自体は同じことだが，このループはPythonで実行されるため，その演算速度は配列演算を使った場合に比べて桁違いに遅い．これは配列演算は実質的にはCで書かれたNumPyライブラリ内で実行されることになるためである．すなわち，Python上で実行される処理は遅いのだが，Pythonから呼び出した関数がCやFortranで実装されていれば，その部分についてはCやFortranで高速に処理することができるのである．</p>
<p>Pythonは様々なことが手軽に実現できる非常に便利な言語であるが，ネックとなるのはその処理の遅さである．(したがって，何も考えずに書くといとも簡単に遅いコードが出来上がってしまう．）NumPy配列を使うことで重たい処理だけを他の言語で書かれた高速なライブラリに押し付けることができ，手軽さと計算速度の速さを両立しているわけである．したがって， <strong>Pythonではループ処理をするのは可能な限り避け，可能な限り配列演算を利用するのが鉄則</strong> である．</p>
</section>
<section id="id9">
<h2><a class="toc-backref" href="#id60" role="doc-backlink"><span class="section-number">6.3. </span>配列オブジェクト</a><a class="headerlink" href="#id9" title="Permalink to this heading"></a></h2>
<p>NumPy配列オブジェクト <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> は多次元配列データを格納し効率的な演算を実現する．</p>
<section id="id10">
<h3><span class="section-number">6.3.1. </span>属性<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h3>
<p>NumPy配列の場合は当然ながら各要素をデータとして持つが，それに加えて以下の属性が重要である．</p>
<table class="docutils align-default" style="width: 100%">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>属性</p></th>
<th class="head"><p>意味</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dtype</span></code></p></td>
<td><p>配列要素のデータ型(整数，実数，複素数など)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ndim</span></code></p></td>
<td><p>次元数</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">size</span></code></p></td>
<td><p>配列サイズ（要素数)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">shape</span></code></p></td>
<td><p>配列形状</p></td>
</tr>
</tbody>
</table>
<p>以下の例を見てみよう． <code class="docutils literal notranslate"><span class="pre">np.arange()</span></code> で生成された配列 <code class="docutils literal notranslate"><span class="pre">x</span></code> について見てみると，これは64bitの整数( <code class="docutils literal notranslate"><span class="pre">int64</span></code> )配列であり，次元数は1，は配列サイズは10である．最後の形状は各次元の長さをtupleで表したものであるが，この場合は1次元配列なので <code class="docutils literal notranslate"><span class="pre">(10,)</span></code> となっている．例えば3次元配列で各次元の長さが 3, 4, 5 だったとすると <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">4,</span> <span class="pre">5,</span> <span class="pre">)</span></code> がその配列の形状となる．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span>
<span class="linenos"> 3</span><span class="go">dtype(&#39;int64&#39;)</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">ndim</span>
<span class="linenos"> 5</span><span class="go">1</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">size</span>
<span class="linenos"> 7</span><span class="go">10</span>
<span class="linenos"> 8</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">shape</span>
<span class="linenos"> 9</span><span class="go">(10,)</span>
<span class="linenos">10</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span><span class="o">.</span><span class="n">shape</span>
<span class="linenos">11</span><span class="go">(2, 3)</span>
</pre></div>
</div>
</section>
<section id="id11">
<h3><span class="section-number">6.3.2. </span>データ型<a class="headerlink" href="#id11" title="Permalink to this heading"></a></h3>
<p>NumPy配列に格納されるデータ型( <code class="docutils literal notranslate"><span class="pre">.dtype</span></code> 属性)はほとんどの場合はCやFortranの組み込み型と同等のものである．以下に代表的なNumPyのデータ型とそれに対応するCやFortranのデータ型を示す．</p>
<table class="docutils align-default" style="width: 100%">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>NumPy</p></th>
<th class="head"><p>型コード</p></th>
<th class="head"><p>C</p></th>
<th class="head"><p>Fortran</p></th>
<th class="head"><p>備考</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.int32</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'i4'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int32_t</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">integer(4)</span></code> / <code class="docutils literal notranslate"><span class="pre">integer</span></code></p></td>
<td><p>32ビット整数(通常はCの <code class="docutils literal notranslate"><span class="pre">int</span></code> ，NumPyの <code class="docutils literal notranslate"><span class="pre">'i'</span></code> )</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.int64</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'i8'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int64_t</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">integer(8)</span></code></p></td>
<td><p>64ビット整数(通常はCの <code class="docutils literal notranslate"><span class="pre">long</span></code> ，NumPyの <code class="docutils literal notranslate"><span class="pre">'l'</span></code> )</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.uint32</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'u4'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">uint32_t</span></code></p></td>
<td></td>
<td><p>32ビット符号なし整数(通常はCの <code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span></code> )</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.uint64</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'u8'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">uint64_t</span></code></p></td>
<td></td>
<td><p>64ビット符号なし整数(通常はCの <code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">long</span></code> )</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.float32</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'f4'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">real(4)</span></code> / <code class="docutils literal notranslate"><span class="pre">real</span></code></p></td>
<td><p>32ビット浮動小数点数(通常はNumPyの <code class="docutils literal notranslate"><span class="pre">'f'</span></code> )</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.float64</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'f8'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">real(8)</span></code></p></td>
<td><p>64ビット浮動小数点数(通常はNumPyの <code class="docutils literal notranslate"><span class="pre">'d'</span></code> ，Python組み込みの <code class="docutils literal notranslate"><span class="pre">float</span></code> )</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.complex64</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'c8'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span> <span class="pre">complex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">complex(4)</span></code> / <code class="docutils literal notranslate"><span class="pre">complex</span></code></p></td>
<td><p>実部・虚部が共に32ビット浮動小数点数の複素数</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.complex128</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'c16'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">complex</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">complex(8)</span></code></p></td>
<td><p>実部・虚部が共に32ビット浮動小数点数の複素数(Python組み込みの <code class="docutils literal notranslate"><span class="pre">complex</span></code> )</p></td>
</tr>
</tbody>
</table>
<p>少し古いデータ型の指定方法では一文字の型コードが使われていた．例えば</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="linenos">2</span><span class="go">dtype(&#39;float64&#39;)</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
<span class="linenos">4</span><span class="go">dtype(&#39;int32&#39;)</span>
</pre></div>
</div>
<p>の例では <code class="docutils literal notranslate"><span class="pre">'d'</span></code> は <code class="docutils literal notranslate"><span class="pre">np.float64</span></code> ， <code class="docutils literal notranslate"><span class="pre">i</span></code> は <code class="docutils literal notranslate"><span class="pre">np.int32</span></code> に対応している．しかし，これは環境に依存して変わってしまう可能性がある(例えば <code class="docutils literal notranslate"><span class="pre">'i'</span></code> が 64ビット整数 <code class="docutils literal notranslate"><span class="pre">np.int64</span></code> の環境もあってもおかしくはない）ので，NumPyでは明示的にデータサイズを示した <code class="docutils literal notranslate"><span class="pre">np.int32</span></code> のような指定が推奨されている．</p>
</section>
</section>
<section id="id12">
<h2><a class="toc-backref" href="#id61" role="doc-backlink"><span class="section-number">6.4. </span>生成</a><a class="headerlink" href="#id12" title="Permalink to this heading"></a></h2>
<p>配列を生成するにはいくつかの方法があるが，以下に何もないところから配列を作るための典型的な例をいくつか示そう．</p>
<section id="id13">
<h3><span class="section-number">6.4.1. </span>シーケンス型からの生成<a class="headerlink" href="#id13" title="Permalink to this heading"></a></h3>
<p>既存のlistやtupleを <code class="docutils literal notranslate"><span class="pre">np.array()</span></code> 関数の引数に与えることでNumPy配列に変換することができる．使い方は以下の例を見れば明らかであろう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>              <span class="c1"># list [0, 1, 2, 3, 4] を変換</span>
<span class="linenos">2</span><span class="go">array([0, 1, 2, 3, 4])</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>                    <span class="c1"># tuple (0, 1, 2) を変換</span>
<span class="linenos">4</span><span class="go">array([0, 1, 2])</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>    <span class="c1"># listのlistを2次元配列に変換</span>
<span class="linenos">6</span><span class="go">array([[0, 1],</span>
<span class="linenos">7</span><span class="go">       [2, 3],</span>
<span class="linenos">8</span><span class="go">       [4, 5]])</span>
</pre></div>
</div>
</section>
<section id="arange">
<h3><span class="section-number">6.4.2. </span>arange<a class="headerlink" href="#arange" title="Permalink to this heading"></a></h3>
<p>すでに見たように <code class="docutils literal notranslate"><span class="pre">np.arange()</span></code> は連番の配列を作る．いくつか別の使い方も見てみよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="linenos">2</span><span class="go">array([10, 12, 14, 16, 18])</span>
</pre></div>
</div>
<p>のように生成される配列の始点，終点，ステップを指定することもできる．指定の仕方は <code class="docutils literal notranslate"><span class="pre">for</span></code> ループでよく用いられる <code class="docutils literal notranslate"><span class="pre">range()</span></code> と同様である．また，</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="linenos">2</span><span class="go">array([0., 1., 2., 3., 4., 5., 6., 7., 8., 9.])</span>
</pre></div>
</div>
<p>のように <code class="docutils literal notranslate"><span class="pre">dtype</span></code> を指定することで，生成される配列のデータ型を指定することもできる．</p>
</section>
<section id="zeros">
<h3><span class="section-number">6.4.3. </span>zeros<a class="headerlink" href="#zeros" title="Permalink to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">np.zeros()</span></code> は0で初期化された配列を作るための関数である．以下の例</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="linenos">2</span><span class="go">array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])</span>
</pre></div>
</div>
<p>ではサイズが10の実数配列を生成している．デフォルトのデータ型が倍精度実数( <code class="docutils literal notranslate"><span class="pre">np.float64</span></code> )であることに注意しよう．このデータ型は <code class="docutils literal notranslate"><span class="pre">dtype</span></code> オプションで指定することができる．</p>
<p>多次元の配列を生成するには，以下のように形状を指定すればよい．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="linenos">2</span><span class="go">array([[0, 0, 0, 0],</span>
<span class="linenos">3</span><span class="go">       [0, 0, 0, 0]], dtype=int32)</span>
</pre></div>
</div>
<p>この例では形状として <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">4)</span></code> を指定しているので0で初期化された2次元配列ができている．</p>
<p>さらに <code class="docutils literal notranslate"><span class="pre">np.zeros_like()</span></code> を使うと，既に存在する別の配列と同じ形状・同じデータ型の配列を生成することもできる．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="linenos">3</span><span class="go">array([[0., 0., 0.],</span>
<span class="linenos">4</span><span class="go">       [0., 0., 0.],</span>
<span class="linenos">5</span><span class="go">       [0., 0., 0.]], dtype=float32)</span>
</pre></div>
</div>
</section>
<section id="ones">
<h3><span class="section-number">6.4.4. </span>ones<a class="headerlink" href="#ones" title="Permalink to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">np.ones()</span></code> は1で初期化する以外は <code class="docutils literal notranslate"><span class="pre">np.zeros()</span></code> と同じように使うことができる．例えば以下は2次元の配列を生成する．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="linenos">2</span><span class="go">array([[1., 1., 1.],</span>
<span class="linenos">3</span><span class="go">       [1., 1., 1.],</span>
<span class="linenos">4</span><span class="go">       [1., 1., 1.]])</span>
</pre></div>
</div>
<p>ここでもデフォルトのデータ型が倍精度実数であることに注意しよう．</p>
<p>同様に <code class="docutils literal notranslate"><span class="pre">np.ones_like()</span></code> も <code class="docutils literal notranslate"><span class="pre">np.zeros_like()</span></code> の代わりに使うことができる．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="linenos">3</span><span class="go">array([[1., 1., 1.],</span>
<span class="linenos">4</span><span class="go">       [1., 1., 1.],</span>
<span class="linenos">5</span><span class="go">       [1., 1., 1.]], dtype=float32)</span>
</pre></div>
</div>
<p>この例のように引数で与えられた配列の形状およびデータ型だけを受け継ぎ，その値は1で初期化されていることに注意しよう．</p>
</section>
<section id="linspace">
<h3><span class="section-number">6.4.5. </span>linspace<a class="headerlink" href="#linspace" title="Permalink to this heading"></a></h3>
<p>ある区間を均等に区切った点列を配列として作成したいときに便利なのが <code class="docutils literal notranslate"><span class="pre">np.linspace()</span></code> である．例えば <span class="math notranslate nohighlight">\(0 \leq x \leq 1\)</span> を均等に区切った配列を生成してみよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="linenos">2</span><span class="go">array([0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ])</span>
</pre></div>
</div>
<p>ここで <code class="docutils literal notranslate"><span class="pre">np.linspace()</span></code> がデフォルトで端点(この場合は <span class="math notranslate nohighlight">\(x = 0\)</span> と <span class="math notranslate nohighlight">\(x = 1\)</span> )を含むことに注意しよう． <span class="math notranslate nohighlight">\(x = 1\)</span> を含まなくても良いのであれば <code class="docutils literal notranslate"><span class="pre">np.arange()</span></code> を用いて</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
<span class="linenos">2</span><span class="go">array([0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9])</span>
</pre></div>
</div>
<p>としてもよい．</p>
</section>
<section id="geomspace-logspace">
<h3><span class="section-number">6.4.6. </span>geomspace / logspace<a class="headerlink" href="#geomspace-logspace" title="Permalink to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">np.linspace()</span></code> によってある区間 <span class="math notranslate nohighlight">\([a, b]\)</span> を線形に均等に区切ることができた．同様に与えられた区間を対数スケールで等間隔に区切るために <code class="docutils literal notranslate"><span class="pre">np.geomspace()</span></code> と <code class="docutils literal notranslate"><span class="pre">np.logspace()</span></code> が提供されている．この両者の違いは <code class="docutils literal notranslate"><span class="pre">np.geomspace()</span></code> には区間の端点の値をそのまま引数として指定するのに対して， <code class="docutils literal notranslate"><span class="pre">np.logspace()</span></code> には <span class="math notranslate nohighlight">\(\log_{10}(a)\)</span> および <span class="math notranslate nohighlight">\(\log_{10}(b)\)</span> を引数として渡すことである．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>  <span class="c1"># [0.1,10]をlogで等間隔に区切る</span>
<span class="linenos">2</span><span class="go">array([ 0.1       ,  0.15848932,  0.25118864,  0.39810717,  0.63095734,</span>
<span class="linenos">3</span><span class="go">        1.        ,  1.58489319,  2.51188643,  3.98107171,  6.30957344,</span>
<span class="linenos">4</span><span class="go">       10.        ])</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>      <span class="c1"># 全く同じ(log10(0.1) = -1, log10(10) = +1)</span>
<span class="linenos">6</span><span class="go">array([ 0.1       ,  0.15848932,  0.25118864,  0.39810717,  0.63095734,</span>
<span class="linenos">7</span><span class="go">        1.        ,  1.58489319,  2.51188643,  3.98107171,  6.30957344,</span>
<span class="linenos">8</span><span class="go">       10.        ])</span>
</pre></div>
</div>
<p>上の2つの例は丸め誤差を除いて以下と全く同一の結果を与える．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">10.0</span><span class="p">),</span> <span class="mi">11</span><span class="p">)</span>
<span class="linenos">2</span><span class="go">array([ 0.1       ,  0.15848932,  0.25118864,  0.39810717,  0.63095734,</span>
<span class="linenos">3</span><span class="go">        1.        ,  1.58489319,  2.51188643,  3.98107171,  6.30957344,</span>
<span class="linenos">4</span><span class="go">       10.        ])</span>
</pre></div>
</div>
</section>
<section id="random">
<h3><span class="section-number">6.4.7. </span>random<a class="headerlink" href="#random" title="Permalink to this heading"></a></h3>
<p>乱数配列を作るのも以下のように簡単にできる．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>               <span class="c1"># [0, 1)の一様乱数(長さ5の配列)</span>
<span class="linenos">2</span><span class="go">array([0.80086594, 0.2513905 , 0.41056114, 0.14083936, 0.74182892])</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># [0, 10)の整数乱数(長さ10の配列)</span>
<span class="linenos">4</span><span class="go">array([2, 4, 4, 3, 1, 0, 4, 2, 2, 1])</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>          <span class="c1"># [0, 1)の一様乱数を形状(3, 2)の2次元配列として</span>
<span class="linenos">6</span><span class="go">array([[0.56945673, 0.5676268 ],</span>
<span class="linenos">7</span><span class="go">       [0.39896178, 0.0149435 ],</span>
<span class="linenos">8</span><span class="go">       [0.35165915, 0.93962764]])</span>
</pre></div>
</div>
<p>なお，ここで <code class="docutils literal notranslate"><span class="pre">np.random.random()</span></code> というのは <code class="docutils literal notranslate"><span class="pre">numpy</span></code> モジュールの中の <code class="docutils literal notranslate"><span class="pre">random</span></code> モジュールの中の <code class="docutils literal notranslate"><span class="pre">random()</span></code> 関数という意味である．</p>
</section>
</section>
<section id="id14">
<h2><a class="toc-backref" href="#id62" role="doc-backlink"><span class="section-number">6.5. </span>入出力</a><a class="headerlink" href="#id14" title="Permalink to this heading"></a></h2>
<p>NumPyは配列の入出力用に便利な関数が用意されており，非常に簡単に使うことができる．</p>
<section id="id15">
<h3><span class="section-number">6.5.1. </span>テキスト入出力<a class="headerlink" href="#id15" title="Permalink to this heading"></a></h3>
<section id="loadtxt">
<h4><span class="section-number">6.5.1.1. </span>loadtxt<a class="headerlink" href="#loadtxt" title="Permalink to this heading"></a></h4>
<p>テキスト形式のデータファイルを読み込むには <code class="docutils literal notranslate"><span class="pre">np.loadtxt()</span></code> が大変便利である．ここではデータファイル <a class="reference external" href="data/helix1.dat">helix1.dat</a> を読み込んでみよう．このファイルの中身は以下のようになっており，値がスペースで区切られている．</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="m">0</span>.81<span class="w">  </span><span class="m">0</span>.59<span class="w">  </span><span class="m">0</span>.50
<span class="linenos">2</span><span class="w"> </span><span class="m">0</span>.31<span class="w">  </span><span class="m">0</span>.95<span class="w">  </span><span class="m">1</span>.00
<span class="linenos">3</span><span class="o">(</span>中略<span class="o">)</span>
<span class="linenos">4</span><span class="w"> </span><span class="m">0</span>.81<span class="w">  </span><span class="m">0</span>.59<span class="w"> </span><span class="m">15</span>.50
<span class="linenos">5</span><span class="w"> </span><span class="m">0</span>.31<span class="w">  </span><span class="m">0</span>.95<span class="w"> </span><span class="m">16</span>.00
</pre></div>
</div>
<p>このファイルは以下のように1行で読み込むことができる．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;helix1.dat&#39;</span><span class="p">)</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">shape</span>
<span class="linenos">3</span><span class="go">(32, 3)</span>
</pre></div>
</div>
<p>読み込んだ結果は2次元配列として返される．この場合は32行 x 3列のデータのため <code class="docutils literal notranslate"><span class="pre">.shape</span></code> 属性は <code class="docutils literal notranslate"><span class="pre">(32,</span> <span class="pre">3)</span></code> となっている． <code class="docutils literal notranslate"><span class="pre">np.loadtxt()</span></code> には多くのオプションがあるが，重要なものは以下の通りである．</p>
<table class="docutils align-default" style="width: 100%">
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>パラメータ名</p></th>
<th class="head"><p>データ型</p></th>
<th class="head"><p>概要</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>dtype</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.dtype</span></code></p></td>
<td><p>デフォルトでは <code class="docutils literal notranslate"><span class="pre">float</span></code> ( <code class="docutils literal notranslate"><span class="pre">np.float64</span></code> )</p></td>
</tr>
<tr class="row-odd"><td><p>delimiter</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td><p>値の区切り文字(デフォルトではスペース)</p></td>
</tr>
<tr class="row-even"><td><p>comments</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td><p>各行のこの文字列に続く部分はコメントとみなされ無視する（デフォルトでは <code class="docutils literal notranslate"><span class="pre">'#'</span></code> )</p></td>
</tr>
<tr class="row-odd"><td><p>skiprows</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td><p>ファイル先端から指定された行数分だけ無視する（デフォルトでは0)</p></td>
</tr>
</tbody>
</table>
<p>例えばスペースではなくカンマ <code class="docutils literal notranslate"><span class="pre">,</span></code> で区切られたいわゆるCSV(Comma-Separated Values)ファイルを読み込むには</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;filename.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>のように区切り文字を指定すればよい．</p>
</section>
<section id="savetxt">
<h4><span class="section-number">6.5.1.2. </span>savetxt<a class="headerlink" href="#savetxt" title="Permalink to this heading"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">np.loadtxt()</span></code> の逆に配列をファイルに出力するには <code class="docutils literal notranslate"><span class="pre">np.savetxt()</span></code> を使えばよい．例えばNumPy配列オブジェクト <code class="docutils literal notranslate"><span class="pre">x</span></code> をoutput.datというファイルに出力するには</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;output.dat&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>とすればよい． 代表的なオプションをいかにいくつか紹介しておこう．</p>
<table class="docutils align-default" style="width: 100%">
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>パラメータ名</p></th>
<th class="head"><p>データ型</p></th>
<th class="head"><p>概要</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>fmt</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td><p>フォーマット文字列</p></td>
</tr>
<tr class="row-odd"><td><p>delimiter</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td><p>値の区切り文字(デフォルトではスペース)</p></td>
</tr>
<tr class="row-even"><td><p>comments</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td><p>ヘッダー・フッター用のコメント文字（デフォルトでは <code class="docutils literal notranslate"><span class="pre">'#'</span></code> )</p></td>
</tr>
<tr class="row-odd"><td><p>header</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td><p>ファイル先端のコメントヘッダー</p></td>
</tr>
<tr class="row-even"><td><p>footer</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td><p>ファイル終端のコメントフッター</p></td>
</tr>
</tbody>
</table>
<p>例えば <a class="reference external" href="data/helix1.dat">helix1.dat</a> を読み込み，同じフォーマットで別のファイルoutput.datに書き込むには</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;helix1.dat&#39;</span><span class="p">)</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s1">&#39;output.dat&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%5.2f</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>のようにフォーマット文字列を指定すればよい．</p>
</section>
</section>
<section id="id17">
<h3><span class="section-number">6.5.2. </span>バイナリ入出力<a class="headerlink" href="#id17" title="Permalink to this heading"></a></h3>
<section id="npynpz">
<h4><span class="section-number">6.5.2.1. </span>NPY形式とNPZ形式<a class="headerlink" href="#npynpz" title="Permalink to this heading"></a></h4>
<p>単一のNumPy配列をバイナリのまま(メモリ上のバイト列をそのまま)ファイルに保存するファイル形式がNPY形式である．これはNumPyの独自フォーマットであるが，その形式は <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.lib.format.html#module-numpy.lib.format">公開</a> されている．さらに，複数のNumPy配列を単一のファイルに書き込む形式がNPZ形式である．まずはNumPy配列をこれらの形式で保存する例を見てみよう．NPY形式には <code class="docutils literal notranslate"><span class="pre">np.save()</span></code> ， またNPZ形式には <code class="docutils literal notranslate"><span class="pre">np.savez()</span></code> をそれぞれ用いる．例として，</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>によって作成した配列を保存してみよう．</p>
<p>NPY形式で保存するには</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;binary1.npy&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>とすればよい．最初の引数がファイル名，2番目の引数が保存する配列である．また，NPZ形式で複数の配列を保存するには</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="s1">&#39;binary1.npz&#39;</span><span class="p">,</span> <span class="n">x_name</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y_name</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>のようにすればよい．ここで <code class="docutils literal notranslate"><span class="pre">np.savez()</span></code> には複数の配列を与えることになるため，それぞれに名前(この例では <code class="docutils literal notranslate"><span class="pre">x_name</span></code> および <code class="docutils literal notranslate"><span class="pre">y_name</span></code> )を与えていることに注意しよう．なお，ここではそれぞれ拡張子を <code class="docutils literal notranslate"><span class="pre">.npy</span></code> ， <code class="docutils literal notranslate"><span class="pre">.npz</span></code> としたファイル名を与えたが，そうでない場合には自動的にこれらの拡張子が付与される．</p>
<p>どちらの形式でもファイルを読み込むときには <code class="docutils literal notranslate"><span class="pre">np.load()</span></code> を用いればよい．NPY形式の場合は <code class="docutils literal notranslate"><span class="pre">np.load()</span></code> は読み込んだデータを直接NumPy配列として返すので，</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;binary1.npy&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>のように使えばよい．ここでは <code class="docutils literal notranslate"><span class="pre">xx</span></code> に読み込まれた配列が代入される．NPZ形式の場合には <code class="docutils literal notranslate"><span class="pre">np.load()</span></code> はdict-likeなオブジェクトを返す．すなわち，</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;binary2.npz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>のように読み込むと <code class="docutils literal notranslate"><span class="pre">data</span></code> はdictのように振る舞うオブジェクトが代入される．したがって，</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">xx</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;x_name&#39;</span><span class="p">]</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">yy</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y_name&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>によってそれぞれNumPy配列が得られる．ここで <code class="docutils literal notranslate"><span class="pre">x_name</span></code> や <code class="docutils literal notranslate"><span class="pre">y_name</span></code> は <code class="docutils literal notranslate"><span class="pre">np.savez()</span></code> に与えた配列の名前である．</p>
</section>
<section id="id19">
<h4><span class="section-number">6.5.2.2. </span>生のバイナリファイル<a class="headerlink" href="#id19" title="Permalink to this heading"></a></h4>
<p>C言語の <code class="docutils literal notranslate"><span class="pre">fwrite()</span></code> 関数やFortranのストリーム出力で作成されたバイナリファイルは他の情報が何も付与されていない「生」のバイナリファイルである．このような生のバイナリファイルは <code class="docutils literal notranslate"><span class="pre">np.fromfile()</span></code> で読み込むことができる．基本的にはPython組み込みの <code class="docutils literal notranslate"><span class="pre">open()</span></code> 関数でファイルを開き， <code class="docutils literal notranslate"><span class="pre">np.fromfile()</span></code> でデータを読めばよい．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 読み込み専用(r)でファイルを開く</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;cbinary.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># np.float64のデータを10個読み込みNumPy配列としてzに代入</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ファイルを閉じる</span>
<span class="linenos">6</span><span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>生のバイナリファイルには余計な情報は一切付与されていないので，データの形式や個数をあらかじめ知っていなければ正しく読み込むことができないことに注意しよう．逆に言えば，それさえ理解してあれば自由自在にファイルを扱うことができる．基本的にファイルの操作は <a class="reference external" href="https://docs.python.org/ja/3/tutorial/inputoutput.html#reading-and-writing-files">公式ドキュメント</a> に従って行えばよく，読み込んだバイト列をNumPy配列として評価したいときにだけ <code class="docutils literal notranslate"><span class="pre">np.fromfile()</span></code> を使えばよい．</p>
</section>
<section id="unformatted-fortran">
<h4><span class="section-number">6.5.2.3. </span>unformatted形式(Fortran)<a class="headerlink" href="#unformatted-fortran" title="Permalink to this heading"></a></h4>
<p>Fortranの <a class="reference external" href="https://amanotk.github.io/fortran-resume-public/chap06.html#id10">unformatted形式</a> は，生のバイナリファイルに近いが，ヘッダとフッタが前後に付与されることが多い <a class="footnote-reference brackets" href="#id50" id="id21" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a> ．ここでは <code class="docutils literal notranslate"><span class="pre">scipy.io.FortranFile</span></code> オブジェクトを用いた読み込み方法を紹介しておこう．</p>
<p>ここでは <a class="reference external" href="https://amanotk.github.io/fortran-resume-public/chap06.html#id27">Fortran演習</a>  で用いたunformatted形式のバイナリファイル <code class="docutils literal notranslate"><span class="pre">helix2.dat</span></code> を読み込んでみよう． <code class="docutils literal notranslate"><span class="pre">FortranFile</span></code> オブジェクトの <code class="docutils literal notranslate"><span class="pre">read_record()</span></code> メソッドはFortranの1回の <code class="docutils literal notranslate"><span class="pre">write</span></code> 文に対応するデータを読み込み，NumPy配列を返す．このファイルには3つの倍精度実数の配列が3回の <code class="docutils literal notranslate"><span class="pre">write</span></code> 文で保存されているので，</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">FortranFile</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ファイルを開く</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span> <span class="o">=</span> <span class="n">FortranFile</span><span class="p">(</span><span class="s1">&#39;helix2.dat&#39;</span><span class="p">)</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 3回のread_recordでそれぞれNumPy配列として読み込み</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read_record</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="linenos">6</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read_record</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="linenos">7</span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read_record</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="linenos">8</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ファイルを閉じる．</span>
<span class="linenos">9</span><span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>のように3回の <code class="docutils literal notranslate"><span class="pre">read_record()</span></code> メソッド呼び出しでそれぞれ読み込めばよい．倍精度実数データを読み込むので <code class="docutils literal notranslate"><span class="pre">np.float64</span></code> を引数に与えていることに注意しよう．なお，1行目は <code class="docutils literal notranslate"><span class="pre">scipy.io</span></code> モジュールから <code class="docutils literal notranslate"><span class="pre">FortranFile</span></code> オブジェクトを読み込むことを意味する．</p>
</section>
<section id="hdf5netcdf">
<h4><span class="section-number">6.5.2.4. </span>HDF5とnetCDF<a class="headerlink" href="#hdf5netcdf" title="Permalink to this heading"></a></h4>
<p>バイナリファイルは高速に読み書きができ，またテキストへの変換がないため，情報が失われることが無いという利点がある．その一方で，可搬性に欠けるという欠点があり，ある計算機で生成したデータが他の計算機ではそのままでは読めないという問題が起こることがある．また，データ読み込みの際にはあらかじめ何が，どのような形式で書かれているかが分からなければデータの読み込みができない．このような欠点を補うファイルフォーマットとして比較的広く使われているのがHDF5である．C言語やFortranでHDF5を扱うのは少々面倒であるが，Pythonであれば <a class="reference external" href="https://www.h5py.org/">h5py</a> というモジュールを使うことで簡単に操作できる．</p>
<p>また同じような目的でnetCDFというデータ形式もあり，気象などの分野で使われているようである．最近のnetCDFは実は中身はHDF5で書かれているようなので，pythonであればやはりh5pyで操作が出来るし，netCDF専用のPythonモジュール( <a class="reference external" href="http://unidata.github.io/netcdf4-python/">netcdf4-python</a> )も存在する．</p>
<p>数値シミュレーションにはC/C++やFortranなどの高速な言語が用いられることが多いが，シミュレーションの結果をこれらの形式で出力しておけば，Pythonを用いた結果の解析が非常にやりやすくなるのである．</p>
</section>
</section>
</section>
<section id="id22">
<h2><a class="toc-backref" href="#id63" role="doc-backlink"><span class="section-number">6.6. </span>各種演算</a><a class="headerlink" href="#id22" title="Permalink to this heading"></a></h2>
<section id="id23">
<h3><span class="section-number">6.6.1. </span>算術演算<a class="headerlink" href="#id23" title="Permalink to this heading"></a></h3>
<p>以下の例を見れば一目瞭然であろう．基本的にFortranの配列と同様な演算ができると思ってよい．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="linenos"> 4</span><span class="go">array([ 4,  6,  8, 10])</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
<span class="linenos"> 6</span><span class="go">array([-4, -4, -4, -4])</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
<span class="linenos"> 8</span><span class="go">array([ 0,  5, 12, 21])</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
<span class="linenos">10</span><span class="go">array([0.        , 0.2       , 0.33333333, 0.42857143])</span>
<span class="linenos">11</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">**</span><span class="mi">2</span>
<span class="linenos">12</span><span class="go">array([0, 1, 4, 9])</span>
</pre></div>
</div>
</section>
<section id="id24">
<h3><span class="section-number">6.6.2. </span>ユニバーサル関数<a class="headerlink" href="#id24" title="Permalink to this heading"></a></h3>
<p>NumPy配列を引数にとり各要素にそれぞれ適用される関数は，NumPyではユニバーサル関数( <code class="docutils literal notranslate"><span class="pre">ufunc</span></code> )と呼ばれている(通常の関数と同じものだと考えてよい)．よく使うであろう数学関数は全て提供されていると考えてよい <a class="footnote-reference brackets" href="#mathfunc" id="id25" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a> ．Fortranなどでは提供されていない関数の使用例をいくつか示しておこう．なお，以下の例はスカラーに対して関数を呼び出しているが，配列を引数に与えた場合には各要素に対して演算した結果を返す．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mf">90.0</span><span class="p">)</span>       <span class="c1"># degreeからradianへの変換</span>
<span class="linenos"> 2</span><span class="go">1.5707963267948966</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>    <span class="c1"># radianからdegreeへの変換</span>
<span class="linenos"> 4</span><span class="go">90.0</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">lcm</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>           <span class="c1"># 最小公倍数</span>
<span class="linenos"> 6</span><span class="go">12</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>         <span class="c1"># 最大公約数</span>
<span class="linenos"> 8</span><span class="go">4</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.0</span><span class="n">j</span><span class="p">)</span>   <span class="c1"># 複素数の偏角</span>
<span class="linenos">10</span><span class="go">0.7853981633974483</span>
</pre></div>
</div>
<p>詳細は <a class="reference external" href="https://numpy.org/doc/stable/reference/routines.math.html">公式ドキュメント</a> を参照のこと．</p>
</section>
<section id="id27">
<h3><span class="section-number">6.6.3. </span>メソッド<a class="headerlink" href="#id27" title="Permalink to this heading"></a></h3>
<p>NumPy配列も当然オブジェクトなのでメソッドを持つ．また，多くのメソッドにはそれと対応する関数が存在する．以下で例を見てみよう．</p>
<p>配列の総和を計算するには <code class="docutils literal notranslate"><span class="pre">np.sum()</span></code> という関数を用いることができる．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="linenos">3</span><span class="go">45</span>
</pre></div>
</div>
<p>これと同じことを配列 <code class="docutils literal notranslate"><span class="pre">x</span></code> のメソッド <code class="docutils literal notranslate"><span class="pre">sum()</span></code> を使って</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="linenos">2</span><span class="go">45</span>
</pre></div>
</div>
<p>と表現することもできる．このように関数とメソッドがどちらも用意されているときにはどちらを使っても全く同じである．(メソッドの方が少しタイプ量が少ないし，タブキーでの補完を考えた時にはよいかもしれない．)
以下にもう少し例を示しておこう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>   <span class="c1"># 最大値</span>
<span class="linenos">2</span><span class="go">9</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>   <span class="c1"># 最小値</span>
<span class="linenos">4</span><span class="go">0</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># 平均値</span>
<span class="linenos">6</span><span class="go">4.5</span>
</pre></div>
</div>
<p>単なる数値的な演算に限らず多くの便利なメソッドが用意されている．詳細は <a class="reference external" href="https://numpy.org/doc/1.18/reference/arrays.ndarray.html#array-methods">公式ドキュメント</a> を参照のこと．</p>
</section>
</section>
<section id="id29">
<h2><a class="toc-backref" href="#id64" role="doc-backlink"><span class="section-number">6.7. </span>インデックス操作</a><a class="headerlink" href="#id29" title="Permalink to this heading"></a></h2>
<p>NumPyのインデックス操作は基本的にFortranの配列操作と似ているのでFortranユーザーには馴染みやすいだろう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>                 <span class="c1"># 3番目の要素</span>
<span class="linenos"> 3</span><span class="go">2</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>               <span class="c1"># 3, 4, 5番目の要素(結果もNumPy配列)</span>
<span class="linenos"> 5</span><span class="go">array([2, 3, 4])</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[:</span><span class="mi">8</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>         <span class="c1"># 0, 2, 4, 6番目の要素に-1を代入</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>                    <span class="c1"># 確認</span>
<span class="linenos"> 8</span><span class="go">array([-1,  1, -1,  3, -1,  5, -1,  7,  8,  9])</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>              <span class="c1"># 順番を反転</span>
<span class="linenos">10</span><span class="go">array([ 9,  8,  7, -1,  5, -1,  3, -1,  1, -1])</span>
<span class="linenos">11</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                <span class="c1"># 最後の要素</span>
<span class="linenos">12</span><span class="go">9</span>
<span class="linenos">13</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>                <span class="c1"># 最後から2番目の要素</span>
<span class="linenos">14</span><span class="go">8</span>
</pre></div>
</div>
<p>Fortranとの違いは負のインデックスを指定すると後ろから順に数えた要素を返すところである．実はこのようなインデックス操作はPython組み込みのシーケンス型(listなど)に対して行うこともできる．NumPy配列はこのインデックス操作をさらに強力なものにする．例えば，以下のようにインデックスを配列で渡すことも可能である．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># インデックス配列を作成</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span>                       <span class="c1"># 確認</span>
<span class="linenos">3</span><span class="go">array([1, 3, 5, 7, 9])</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span>               <span class="c1"># 2倍にする</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>                       <span class="c1"># 確認</span>
<span class="linenos">6</span><span class="go">array([-1,  2, -1,  6, -1, 10, -1, 14,  8, 18])</span>
<span class="linenos">7</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                  <span class="c1"># インデックスを一つずらす</span>
<span class="linenos">8</span><span class="go">array([-1, -1, -1, -1,  8])</span>
</pre></div>
</div>
<p>のように使うことができる．(これは差分法に使うときなどに便利である．)</p>
<p>さらに，多次元配列のインデックス操作についても例を見てみよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="c1"># 長さ20の配列をreshapeで2次元配列に変換</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<span class="linenos"> 3</span><span class="go">array([[ 0,  1,  2,  3,  4],</span>
<span class="linenos"> 4</span><span class="go">       [ 5,  6,  7,  8,  9],</span>
<span class="linenos"> 5</span><span class="go">       [10, 11, 12, 13, 14],</span>
<span class="linenos"> 6</span><span class="go">       [15, 16, 17, 18, 19]])</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>                            <span class="c1"># 1次元目は0，2次元目は全て</span>
<span class="linenos"> 8</span><span class="go">array([0, 1, 2, 3, 4])</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>                            <span class="c1"># 1次元目は全て，2次元目は1</span>
<span class="linenos">10</span><span class="go">array([ 1,  6, 11, 16])</span>
<span class="linenos">11</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>                        <span class="c1"># 両次元とも1, 2番目の要素</span>
<span class="linenos">12</span><span class="go">array([[ 6,  7],</span>
<span class="linenos">13</span><span class="go">       [11, 12]])</span>
</pre></div>
</div>
<p>より高次元の配列を扱う際には <code class="docutils literal notranslate"><span class="pre">...</span></code> が便利である <a class="footnote-reference brackets" href="#ellipsis" id="id30" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a> ．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="c1"># 3次元配列</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span>
<span class="linenos"> 3</span><span class="go">array([[[ 0,  1,  2],</span>
<span class="linenos"> 4</span><span class="go">        [ 3,  4,  5],</span>
<span class="linenos"> 5</span><span class="go">        [ 6,  7,  8]],</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="go">       [[ 9, 10, 11],</span>
<span class="linenos"> 8</span><span class="go">        [12, 13, 14],</span>
<span class="linenos"> 9</span><span class="go">        [15, 16, 17]]])</span>
<span class="linenos">10</span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>                             <span class="c1"># z[:,:,0]と同じ</span>
<span class="linenos">11</span><span class="go">array([[ 0,  3,  6],</span>
<span class="linenos">12</span><span class="go">       [ 9, 12, 15]])</span>
<span class="linenos">13</span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>                           <span class="c1"># z[1,:,0]と同じ</span>
<span class="linenos">14</span><span class="go">array([ 9, 12, 15])</span>
<span class="linenos">15</span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                                 <span class="c1"># z[1,:,:]と同じ</span>
<span class="linenos">16</span><span class="go">array([[ 9, 10, 11],</span>
<span class="linenos">17</span><span class="go">       [12, 13, 14],</span>
<span class="linenos">18</span><span class="go">       [15, 16, 17]])</span>
</pre></div>
</div>
<p>他にも色々と便利なのだがあまりにも機能が沢山あるので，これ以上は <a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.indexing.html#arrays-indexing">公式ドキュメント</a> を参照して欲しい．一つだけ配列の代入について注意しておこう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># 配列の全要素に10を代入</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>         <span class="c1"># 確認</span>
<span class="linenos">3</span><span class="go">array([10, 10, 10, 10, 10, 10, 10, 10, 10, 10])</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>    <span class="c1"># 整数10をxに代入</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>         <span class="c1"># xはスカラー</span>
<span class="linenos">6</span><span class="go">10</span>
</pre></div>
</div>
<p>このように1行目と4行目では動作が異なる．Fortranでは4行目のように記述しても配列の全要素に10を代入してくれるが，Pythonでは <strong>新しい変数を作り，そこに整数10を代入</strong> する．これは動的型付け言語のPythonならではの動作である．配列の全要素にスカラー値を代入する際にはインデックスに <code class="docutils literal notranslate"><span class="pre">:</span></code> (もしくは <code class="docutils literal notranslate"><span class="pre">...</span></code> )を指定しなければならない．</p>
</section>
<section id="id32">
<h2><a class="toc-backref" href="#id65" role="doc-backlink"><span class="section-number">6.8. </span>形状操作</a><a class="headerlink" href="#id32" title="Permalink to this heading"></a></h2>
<p>配列の形状は決して固定のものではない．実はこれまでの例にも既に出てきたが，</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="linenos">4</span><span class="go">array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<span class="linenos">6</span><span class="go">array([[0, 1, 2, 3, 4],</span>
<span class="linenos">7</span><span class="go">       [5, 6, 7, 8, 9]])</span>
</pre></div>
</div>
<p>のように <code class="docutils literal notranslate"><span class="pre">reshape()</span></code> メソッドによって配列の形状を変更することができる．この例ではまず長さ10の1次元配列 <code class="docutils literal notranslate"><span class="pre">x</span></code> を作って，それを形状(2, 5)の2次元配列 <code class="docutils literal notranslate"><span class="pre">y</span></code> に変換している．一体何が起こっているのだろうか？試しに <code class="docutils literal notranslate"><span class="pre">y</span></code> の要素を変更してみよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="linenos">3</span><span class="go">array([ 0,  1,  2,  3,  4, -1,  6,  7,  8,  9])</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<span class="linenos">5</span><span class="go">array([[ 0,  1,  2,  3,  4],</span>
<span class="linenos">6</span><span class="go">       [-1,  6,  7,  8,  9]])</span>
</pre></div>
</div>
<p>ここで変更したのはあくまで <code class="docutils literal notranslate"><span class="pre">y</span></code> の一つの要素であるが，それに伴って <code class="docutils literal notranslate"><span class="pre">x</span></code> の要素も変更されていることに注意しよう．すなわち， <code class="docutils literal notranslate"><span class="pre">x</span></code> も <code class="docutils literal notranslate"><span class="pre">y</span></code> もある連続したメモリブロック(この場合は8 byte x 10個 = 80 byte)への参照でしかない(つまりデータの実態は同じもの) <a class="footnote-reference brackets" href="#sharememory" id="id33" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a> ． <code class="docutils literal notranslate"><span class="pre">y</span></code> に対しては2つのインデックスを使って要素を指定するが，これはあくまで人間から見た時の考えやすさのためにそうしてるに過ぎない．(これは何もPythonに限ったことでなく，Fortranでも同じことである．Cの場合は少し事情が複雑だが，staticな配列に限定すればやはり同じである．)</p>
<p>したがって，当然ながら <code class="docutils literal notranslate"><span class="pre">reshape()</span></code> 前後で要素数が同じである必要がある．試しに <code class="docutils literal notranslate"><span class="pre">x</span></code> を形状(3, 5)に変換しようとしても</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="linenos">2</span><span class="gt">Traceback (most recent call last):</span>
<span class="linenos">3</span>  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="linenos">4</span><span class="gr">ValueError</span>: <span class="n">cannot reshape array of size 10 into shape (3,5)</span>
</pre></div>
</div>
<p>のようにエラーとなる．</p>
<p>多次元配列の連続したメモリブロックを新たな1次元配列として得るために <code class="docutils literal notranslate"><span class="pre">ravel()</span></code> メソッドを使うことができる．似たようなメソッドとして <code class="docutils literal notranslate"><span class="pre">flatten()</span></code> があるが，これらの違いはなんだろうか．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="linenos">4</span><span class="go">array([ 0,  1,  2,  3,  4, -1,  6,  7,  8,  9])</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="linenos">6</span><span class="go">array([ 0,  1,  2,  3,  4, -1,  6,  7,  8,  9])</span>
</pre></div>
</div>
<p>見た目ではどちらも同じように見える．ここで <code class="docutils literal notranslate"><span class="pre">y</span></code> の要素を再び変更してみよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="linenos">3</span><span class="go">array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="linenos">5</span><span class="go">array([ 0,  1,  2,  3,  4, -1,  6,  7,  8,  9])</span>
</pre></div>
</div>
<p>このように <code class="docutils literal notranslate"><span class="pre">ravel()</span></code> で作られた <code class="docutils literal notranslate"><span class="pre">a</span></code> は同じメモリブロックを参照しているのに対して， <code class="docutils literal notranslate"><span class="pre">flatten()</span></code> で作られた <code class="docutils literal notranslate"><span class="pre">b</span></code> は異なる領域を指していることが分かる．すなわち <code class="docutils literal notranslate"><span class="pre">flatten()</span></code> は新たなメモリブロックを確保し，データをコピーする．一方で， <code class="docutils literal notranslate"><span class="pre">ravel()</span></code> は単なる参照でしかない．当然 <code class="docutils literal notranslate"><span class="pre">ravel()</span></code> はデータをコピーする手間がない分高速に動作することに注意しよう．</p>
<p>なお，ここで紹介した形状操作はあくまでも初級編である．NumPyの演算速度を最大限に活かそうと思うと，このような配列形状の変更には思いのほか頻繁に出くわすことになるので少しずつ慣れていこう．</p>
</section>
<section id="id34">
<h2><a class="toc-backref" href="#id66" role="doc-backlink"><span class="section-number">6.9. </span>第6章 演習課題</a><a class="headerlink" href="#id34" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>以下の課題はJupyter Notebookの使用を前提としているが，もちろん他の実行環境でも同等の処理を実現出来ていれば問題ない．ただし，この章の目的はNumPy配列の使い方の習得なので，以下の課題では <strong>可能な限りループを使わず</strong> NumPyの機能を活かした実装を目指そう．</p>
<p>なお，以下では</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
<p>のように必要なモジュールが <code class="docutils literal notranslate"><span class="pre">import</span></code> されているものとする．</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<a href="answer/chap06/kadai.html"> 解答例 </a>
<a href="https://colab.research.google.com/github/amanotk/python-resume-answer/blob/main/chap06/kadai.ipynb" target="_blank">
<img src="https://colab.research.google.com/assets/colab-badge.svg" style="vertical-align: text-top;">
</a></div>
<section id="id35">
<h3><span class="section-number">6.9.1. </span>課題1<a class="headerlink" href="#id35" title="Permalink to this heading"></a></h3>
<p>サンプルを実行して動作を確認せよ．</p>
</section>
<section id="id36">
<h3><span class="section-number">6.9.2. </span>課題2<a class="headerlink" href="#id36" title="Permalink to this heading"></a></h3>
<p>整数 <code class="docutils literal notranslate"><span class="pre">N</span></code> を引数として受け取り， <span class="math notranslate nohighlight">\(0^{\circ} \leq \theta \leq 180^{\circ}\)</span> をN分割した点(端点を含むのでN+1点)，およびそれらの点における <span class="math notranslate nohighlight">\(\sin \theta\)</span> ， <span class="math notranslate nohighlight">\(\cos \theta\)</span> の値をそれぞれ配列として返す関数</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">trigonometric</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;θ, sinθ, cosθの値を出力する&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成せよ．これを呼び出し，例えば以下のようにプロットして結果を確認しよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">trigonometric</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id51">
<img alt="_images/chap06_trigonometric.png" src="_images/chap06_trigonometric.png" />
<figcaption>
<p><span class="caption-text">課題2</span><a class="headerlink" href="#id51" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id37">
<h3><span class="section-number">6.9.3. </span>課題3<a class="headerlink" href="#id37" title="Permalink to this heading"></a></h3>
<p>以下の級数展開</p>
<div class="math notranslate nohighlight">
\[e \simeq \sum_{n=0}^{N} \frac{1}{n !}. \quad (0! = 1に注意せよ)\]</div>
<p>により自然対数の底 <span class="math notranslate nohighlight">\(e\)</span> の近似値を求める関数 <code class="docutils literal notranslate"><span class="pre">approx_e()</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">approx_e</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;自然対数の底を級数展開を用いて求める&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．ただし整数 <code class="docutils literal notranslate"><span class="pre">N</span></code> を引数として受け取り，内部ではNumPy配列を使うことでループを用いない実装とせよ．</p>
<p>ここで，階乗とガンマ関数の関係式</p>
<div class="math notranslate nohighlight">
\[\Gamma(n) = (n-1)!\]</div>
<p>を用いてよい．ガンマ関数は <code class="docutils literal notranslate"><span class="pre">scipy.special.gamma()</span></code> を用いればよい．以下はその使用例である．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">special</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># 2!</span>
<span class="linenos">3</span><span class="go">2.0</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># 3!</span>
<span class="linenos">5</span><span class="go">6.0</span>
</pre></div>
</div>
<p>この関数を用いると例えば以下のような結果が得られる．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&gt;20.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Approximated&#39;</span><span class="p">,</span> <span class="n">approx_e</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&gt;20.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Exact&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="p">))</span>
<span class="linenos">3</span><span class="go">Approximated         : 2.71828152557319e+00</span>
<span class="linenos">4</span><span class="go">Exact                : 2.71828182845905e+00</span>
</pre></div>
</div>
</section>
<section id="id38">
<h3><span class="section-number">6.9.4. </span>課題4<a class="headerlink" href="#id38" title="Permalink to this heading"></a></h3>
<p>以下の漸化式</p>
<div class="math notranslate nohighlight">
\[p_{n+1} = p_n + \alpha p_n (1 - p_n)\]</div>
<p>で定義される数列 <span class="math notranslate nohighlight">\(p_n (n=0, 1, \ldots)\)</span> を考える．<span class="math notranslate nohighlight">\(1 &lt; \alpha &lt; 3\)</span> を <span class="math notranslate nohighlight">\(m\)</span> 分割し，各 <span class="math notranslate nohighlight">\(\alpha\)</span> について初期値 <span class="math notranslate nohighlight">\(p_0 = 0.9\)</span> から数列を生成し，そのうち <span class="math notranslate nohighlight">\(n=100, \ldots, 200\)</span> を <span class="math notranslate nohighlight">\(\alpha\)</span> の関数としてプロットしよう．</p>
<p>これには，整数 <code class="docutils literal notranslate"><span class="pre">m</span></code> を引数にとり，<span class="math notranslate nohighlight">\(\alpha\)</span> と <span class="math notranslate nohighlight">\(p_n (n=100, \ldots, 200)\)</span> の組を返す関数 <code class="docutils literal notranslate"><span class="pre">logistic()</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">logistic</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;0 &lt; α &lt; 1 をm分割して，それぞれに対してロジスティック写像を計算&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成し，この関数を用いて</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">logistic</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">)</span>
</pre></div>
</div>
<p>とすればよい．結果は以下の通りである．</p>
<figure class="align-center" id="id52">
<img alt="_images/chap06_logistic.png" src="_images/chap06_logistic.png" />
<figcaption>
<p><span class="caption-text">課題4</span><a class="headerlink" href="#id52" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
<p>このような写像はロジスティック写像と呼ばれ，非常に単純な式ながら一定の条件を満たすときにはカオスを生み出すことが知られている．</p>
</section>
<section id="id39">
<h3><span class="section-number">6.9.5. </span>課題5<a class="headerlink" href="#id39" title="Permalink to this heading"></a></h3>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p>アルゴリズムについては <a class="reference external" href="https://amanotk.github.io/fortran-resume-public/chap08.html#c8-numerical-integration">こちら</a> を参照．</p>
</div>
<p>以下の積分</p>
<div class="math notranslate nohighlight">
\[\int_{0}^{1} \frac{4}{\pi} \frac{1}{1 + x^2} dx\]</div>
<p>を台形公式およびSimpsonの公式を使って求める関数をそれぞれ作成しよう．ここで作成する関数は分割数 <code class="docutils literal notranslate"><span class="pre">n</span></code> を引数にとり，</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">trapezoid</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;分割数nの台形公式で関数を積分&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="k">def</span> <span class="nf">simpson</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="linenos">6</span>    <span class="s2">&quot;分割数nのSimpson公式で関数を積分&quot;</span>
<span class="linenos">7</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>のような形になるものとする．ただし関数内ではループを使わずに実装すること．これらの積分公式の誤差の分割数依存性は次のようにすれば調べることができる．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="mi">16</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">err1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">err2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt; </span>    <span class="n">err1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="gp">&gt;&gt;&gt; </span>    <span class="n">err2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simpson</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos">10</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 結果をプロット</span>
<span class="linenos">11</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">err1</span><span class="p">,</span> <span class="s1">&#39;rx-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;trapezoid&#39;</span><span class="p">)</span>
<span class="linenos">12</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">err2</span><span class="p">,</span> <span class="s1">&#39;bx-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;simpson&#39;</span><span class="p">)</span>
<span class="linenos">13</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
<span class="linenos">14</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>これによって得られる図は以下の通りである．</p>
<figure class="align-center" id="id53">
<img alt="_images/chap06_integration.png" src="_images/chap06_integration.png" />
<figcaption>
<p><span class="caption-text">課題5</span><a class="headerlink" href="#id53" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id41">
<h3><span class="section-number">6.9.6. </span>課題6<a class="headerlink" href="#id41" title="Permalink to this heading"></a></h3>
<p>データファイルに格納されている学生のテスト点数リストから，最高点，最大点，平均点，標準偏差を求めて返す関数 <code class="docutils literal notranslate"><span class="pre">analyze_score()</span></code> を作成しよう．ただし，</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">analyze_score</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;filenameからデータを読んで最高点，最低点，平均点，標準偏差を返す&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>のようにファイル名を引数にとるものとする．ここで，それぞれ対応する関数( <code class="docutils literal notranslate"><span class="pre">np.max()</span></code> ， <code class="docutils literal notranslate"><span class="pre">np.min()</span></code> ， <code class="docutils literal notranslate"><span class="pre">np.mean()</span></code> ， <code class="docutils literal notranslate"><span class="pre">np.std()</span></code> )またはNumPy配列のメソッドを用いること．</p>
<p>なお，データファイルは <a class="reference external" href="sample/chap06/score1.dat">score1.dat</a> および <a class="reference external" href="sample/chap06/score2.dat">score2.dat</a> とし，以下のようにこのファイルの最初の行にはデータ数，次の行は空行，以降に実際のデータが格納されている．</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>$<span class="w"> </span>cat<span class="w"> </span>score1.dat
<span class="linenos">2</span><span class="m">30</span><span class="w">      </span><span class="c1"># データ数</span>
<span class="linenos">3</span><span class="w">        </span><span class="c1"># 空白行</span>
<span class="linenos">4</span><span class="m">20</span><span class="w">      </span><span class="c1"># 実際のデータはこれ以降の行</span>
<span class="linenos">5</span><span class="m">49</span>
<span class="linenos">6</span><span class="m">45</span>
<span class="linenos">7</span><span class="o">(</span>以下略）
</pre></div>
</div>
<p>したがって， <code class="docutils literal notranslate"><span class="pre">np.loadtxt()</span></code> のオプション <code class="docutils literal notranslate"><span class="pre">skiprows</span></code> を用いて最初の2行を無視して読み込めばよい．</p>
<p>例えばscore1.datを読み込んだ場合には以下のような結果が得られる．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">smax</span><span class="p">,</span> <span class="n">smin</span><span class="p">,</span> <span class="n">savg</span><span class="p">,</span> <span class="n">sstd</span> <span class="o">=</span> <span class="n">analyze_score</span><span class="p">(</span><span class="s1">&#39;score1.dat&#39;</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:10}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Best&#39;</span><span class="p">,</span> <span class="n">smax</span><span class="p">))</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:10}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Worst&#39;</span><span class="p">,</span> <span class="n">smin</span><span class="p">))</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:10.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">savg</span><span class="p">))</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:10.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Standard deviation&#39;</span><span class="p">,</span> <span class="n">sstd</span><span class="p">))</span>
<span class="linenos"> 7</span><span class="go">Best                 :         98</span>
<span class="linenos"> 8</span><span class="go">Worst                :          6</span>
<span class="linenos"> 9</span><span class="go">Average              :     46.400</span>
<span class="linenos">10</span><span class="go">Standard deviation   :     25.115</span>
</pre></div>
</div>
<p>同様にscore2.datについても試してみること．</p>
</section>
<section id="id42">
<h3><span class="section-number">6.9.7. </span>課題7<a class="headerlink" href="#id42" title="Permalink to this heading"></a></h3>
<p>前問のscore1.datおよびscore2.datのようなデータファイルを読み込みヒストグラムを作成する関数 <code class="docutils literal notranslate"><span class="pre">hist_score()</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">hist_score</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">nbin</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;filenameからデータを読んでヒストグラムを作成する&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．ここで引数 <code class="docutils literal notranslate"><span class="pre">nbin</span></code> はビンの数である．関数 <code class="docutils literal notranslate"><span class="pre">np.histogram()</span></code> を用いること．</p>
<p>実行例は以下のようになる．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">nbin</span> <span class="o">=</span> <span class="mi">20</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">bins</span><span class="p">,</span> <span class="n">hist</span> <span class="o">=</span> <span class="n">hist_score</span><span class="p">(</span><span class="s1">&#39;score2.dat&#39;</span><span class="p">,</span> <span class="n">nbin</span><span class="p">)</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">binw</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">hist</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">binw</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;edge&#39;</span><span class="p">)</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id54">
<img alt="_images/chap06_score.png" src="_images/chap06_score.png" />
<figcaption>
<p><span class="caption-text">課題7</span><a class="headerlink" href="#id54" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id43">
<h3><span class="section-number">6.9.8. </span>課題8<a class="headerlink" href="#id43" title="Permalink to this heading"></a></h3>
<p>データファイル <a class="reference external" href="sample/chap06/vector.dat">vector.dat</a> に格納されている2つのベクトルを読み込み，それらの内積を求める関数 <code class="docutils literal notranslate"><span class="pre">dot_file()</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">dot_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;filenameから2つのベクトルを読み込み，それらの内積を返す&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．関数 <code class="docutils literal notranslate"><span class="pre">np.dot()</span></code> を用いること．ただし，以下のようにvector.datの最初の行にはベクトルの長さ，次の行は空白，ベクトル1の各要素，空白行，ベクトル2の各要素，のようにデータが格納されている．</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="m">20</span><span class="w">                      </span><span class="c1"># データ数</span>
<span class="linenos"> 2</span><span class="w">                        </span><span class="c1"># 空白行</span>
<span class="linenos"> 3</span><span class="m">1</span>.000000000000000e+00
<span class="linenos"> 4</span><span class="m">9</span>.510565162951535e-01
<span class="linenos"> 5</span><span class="o">(</span>中略<span class="o">)</span>
<span class="linenos"> 6</span><span class="m">8</span>.090169943749473e-01
<span class="linenos"> 7</span><span class="m">9</span>.510565162951535e-01
<span class="linenos"> 8</span><span class="w">                        </span><span class="c1"># 空白行</span>
<span class="linenos"> 9</span><span class="m">0</span>.000000000000000e+00
<span class="linenos">10</span><span class="m">3</span>.090169943749474e-01
<span class="linenos">11</span><span class="o">(</span>中略<span class="o">)</span>
<span class="linenos">12</span>-5.877852522924734e-01
<span class="linenos">13</span>-3.090169943749476e-01
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">np.loadtxt()</span></code> のオプション <code class="docutils literal notranslate"><span class="pre">skiprows</span></code> を用いて最初の2行を無視して読み込むと以降のデータが全て1次元配列として返される(区切りの空白行は無視される)ので，この前半と後半をそれぞれ別のベクトルとして処理すればよい．</p>
</section>
<section id="id44">
<h3><span class="section-number">6.9.9. </span>課題9<a class="headerlink" href="#id44" title="Permalink to this heading"></a></h3>
<p>任意の長さの1次元整数型配列に与えられた整数が含まれているかどうかを調べ，含まれていた時には真 ( <code class="docutils literal notranslate"><span class="pre">True</span></code> ，そうでなければ偽 <code class="docutils literal notranslate"><span class="pre">False</span></code> )を返す関数 <code class="docutils literal notranslate"><span class="pre">find_var</span></code> を作成しよう．また同様に，値が含まれていた時にはその要素のインデックスを返し，そうでなければ-1を返す関数 <code class="docutils literal notranslate"><span class="pre">find_var_index()</span></code> を作成しよう．実装は色々考えられるが， <code class="docutils literal notranslate"><span class="pre">np.any()</span></code> や <code class="docutils literal notranslate"><span class="pre">np.nonzero()</span></code> または <code class="docutils literal notranslate"><span class="pre">np.where()</span></code> などを使うとよい．</p>
<p>これらの関数を</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">find_var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;varが配列xに含まれているかどうかを調べる&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="k">def</span> <span class="nf">find_var_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
<span class="linenos">6</span>    <span class="s2">&quot;varが配列xに含まれている時にはそのインデックスを，そうでない場合は-1を返す&quot;</span>
<span class="linenos">7</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>のように定義し，以下のように動作を確かめよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="linenos"> 3</span><span class="go">array([17, 75, 28, 83, 93, 20, 19, 94, 62, 61])</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="go">True</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="go">False</span>
<span class="linenos"> 8</span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_var_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="go">2</span>
<span class="linenos">10</span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_var_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="linenos">11</span><span class="go">-1</span>
</pre></div>
</div>
<p>さらに， <code class="docutils literal notranslate"><span class="pre">np.random.randint()</span></code> を用いて適当な長さの1次元整数配列を作成し，値を探索してみよう．</p>
</section>
<section id="id45">
<h3><span class="section-number">6.9.10. </span>課題10<a class="headerlink" href="#id45" title="Permalink to this heading"></a></h3>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p>1次元のセル・オートマトンについては <a class="reference external" href="https://ja.wikipedia.org/wiki/%E3%82%BB%E3%83%AB%E3%83%BB%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%83%88%E3%83%B3#1%E6%AC%A1%E5%85%83%E3%82%BB%E3%83%AB%E3%83%BB%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%83%88%E3%83%B3">Wikipedia</a> を参照．</p>
</div>
<p>1次元のセル・オートマトンを実装しよう．具体的には，以下のような関数を作成し，10進数で与えられたルール <code class="docutils literal notranslate"><span class="pre">decrule</span></code> に基づいて，一次元配列 <code class="docutils literal notranslate"><span class="pre">x</span></code> を初期値とし， <code class="docutils literal notranslate"><span class="pre">step</span></code> 数だけ状態遷移を求めよう．関数の返値は2次元配列で，各ステップ，各セルの状態を表すものとする．ただし，境界の値は初期値のまま固定でよい．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">cellular_automaton</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">decrule</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;初期値xからstep数だけセル・オートマトンによる状態遷移を求める&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>例えば以下の例ではルール90を採用し，初期値として中央のセルのみを1とし，それ以外は0を与えている．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">256</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">xzero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">xzero</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos">6</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">cellular_automaton</span><span class="p">(</span><span class="n">xzero</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="linenos">7</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray_r</span><span class="p">)</span>
</pre></div>
</div>
<p>これはシェルピンスキーのギャスケット（下図）を生成することが知られている．</p>
<figure class="align-center" id="id55">
<img alt="_images/chap06_rule90.png" src="_images/chap06_rule90.png" />
<figcaption>
<p><span class="caption-text">課題10</span><a class="headerlink" href="#id55" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id46">
<h3><span class="section-number">6.9.11. </span>課題11<a class="headerlink" href="#id46" title="Permalink to this heading"></a></h3>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p>アルゴリズムについては <a class="reference external" href="https://amanotk.github.io/fortran-resume-public/chap08.html#id18">こちら</a> を参照．</p>
</div>
<p>逆関数法を使って指数分布</p>
<div class="math notranslate nohighlight">
\[P(x) = \lambda \exp ( - \lambda x )\]</div>
<p>に従う乱数を返す関数 <code class="docutils literal notranslate"><span class="pre">randexp()</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">randexp</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;指数分布に従う乱数をn個作成する&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．(ただし，実用上は指数分布に従う乱数は <code class="docutils literal notranslate"><span class="pre">numpy.random.exponential()</span></code> によって得られるので，これを用いればよい．）</p>
<p>この関数を用いて発生させた乱数と解析的な確率分布を以下のように比較しよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">randexp</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">60000</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ヒストグラム</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">hist</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">hist</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 解析的な分布</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="linenos"> 8</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">l</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">l</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="linenos">10</span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">()</span>
</pre></div>
</div>
<p>この結果は以下のようになる．</p>
<figure class="align-center" id="id56">
<img alt="_images/chap06_exponential.png" src="_images/chap06_exponential.png" />
<figcaption>
<p><span class="caption-text">課題11</span><a class="headerlink" href="#id56" title="この画像へのパーマリンク"></a></p>
</figcaption>
</figure>
</section>
<section id="id48">
<h3><span class="section-number">6.9.12. </span>課題12<a class="headerlink" href="#id48" title="Permalink to this heading"></a></h3>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<p>アルゴリズムについては <a class="reference external" href="https://amanotk.github.io/fortran-resume-public/chap08.html#id19">こちら</a> を参照．</p>
</div>
<p>モンテカルロ法を用いてN次元超球の体積を求める関数 <code class="docutils literal notranslate"><span class="pre">mc_hypersphere()</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">mc_hypersphere</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nrand</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;n次元超球の体積をモンテカルロ法で求める&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．ここで <code class="docutils literal notranslate"><span class="pre">nrand</span></code> は各次元について発生させる乱数の個数である．</p>
<p>この関数を使って近似値と解析的な値を以下のように比較しよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">nrand</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&lt;20.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Monte-Carlo&#39;</span><span class="p">,</span> <span class="n">mc_hypersphere</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nrand</span><span class="p">)))</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&lt;20.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Exact&#39;</span><span class="p">,</span> <span class="n">hypersphere</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
<span class="linenos">5</span><span class="go">Monte-Carlo          : 4.18304000000000e+00</span>
<span class="linenos">6</span><span class="go">Exact                : 4.18879020478639e+00</span>
</pre></div>
</div>
<p>ただし，解析的な値を返す関数 <code class="docutils literal notranslate"><span class="pre">hypersphere()</span></code> を別途定義するものとする．</p>
<hr class="docutils" />
<aside class="footnote brackets" id="numpylib" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">1</a><span class="fn-bracket">]</span></span>
<p>これはPythonに組み込みのライブラリではないので別途インストールする必要があるが，ほとんどの環境には入っていると思われるのでここではあるものとして考える．</p>
</aside>
<aside class="footnote brackets" id="np-ndarray" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">2</a><span class="fn-bracket">]</span></span>
<p>正確にはクラス <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> のインスタンスと呼ぶべきかもしれないが，ここでは細かいことは置いておこう．</p>
</aside>
<aside class="footnote brackets" id="numpymath" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">3</a><span class="fn-bracket">]</span></span>
<p>このようにNumPyの数学関数はスカラーに対してもNumPy配列に対しても有効である．さらに，標準の <code class="docutils literal notranslate"><span class="pre">math</span></code> モジュールよりも多くの数学関数が用意されているので，特に理由がない限りは常にNumPyの数学関数を用いるのが簡単であろう．</p>
</aside>
<aside class="footnote brackets" id="intrinsicarray" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">4</a><span class="fn-bracket">]</span></span>
<p>Pythonにも配列を提供する <code class="docutils literal notranslate"><span class="pre">array</span></code> という組み込みのモジュールがあるのだが，NumPy配列があまりにも便利で普及しているのでそれほどお目にかかることはないだろう．</p>
</aside>
<aside class="footnote brackets" id="mathfunc" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id25">5</a><span class="fn-bracket">]</span></span>
<p>NumPyで提供されていないような特殊関数であっても，ほとんどはSciPyの特殊関数モジュール <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html">scipy.special</a> に実装されているであろう．ここで提供されていない関数が必要になることは稀である．</p>
</aside>
<aside class="footnote brackets" id="ellipsis" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id30">6</a><span class="fn-bracket">]</span></span>
<p><code class="docutils literal notranslate"><span class="pre">...</span></code> は <code class="docutils literal notranslate"><span class="pre">Ellipsis</span></code> Pythonのオブジェクトというものであり，何かが省略されていることを意味する．</p>
</aside>
<aside class="footnote brackets" id="sharememory" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id33">7</a><span class="fn-bracket">]</span></span>
<p>疑り深い人はもっと直接的に確かめてみよう． <code class="docutils literal notranslate"><span class="pre">shares_memory()</span></code> 関数は与えられた2つのNumPy配列が同じメモリ領域を指しているかどうかをチェックする．これを使うと</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">shares_memory</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="linenos">2</span><span class="go">True</span>
</pre></div>
</div>
<p>のように，確かに <code class="docutils literal notranslate"><span class="pre">x</span></code> と <code class="docutils literal notranslate"><span class="pre">y</span></code> が同じメモリ領域を指していることがわかる．</p>
</aside>
<aside class="footnote brackets" id="id50" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id21">8</a><span class="fn-bracket">]</span></span>
<p>ただし，unformatted形式は標準化されておらず，コンパイラやエンディアン(CPUの種類)などに依存する形式なので，可能な限りその使用を避けた方が無難である．(比較的新しいストリーム入出力を使えばよい．)</p>
</aside>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="chap05.html" class="btn btn-neutral float-left" title="5. 便利な組み込み型" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="chap07.html" class="btn btn-neutral float-right" title="7. スクリプトとしてのPython" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Takanobu Amano.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>