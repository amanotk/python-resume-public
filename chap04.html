<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4. 制御構造と関数・オブジェクト &mdash; Python演習(地球惑星物理学演習)</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="5. 便利な組み込み型" href="chap05.html" />
    <link rel="prev" title="3. 対話型の実行方法" href="chap03.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Python演習
          </a>
              <div class="version">
                2023
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="chap01.html">1. はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap02.html">2. Pythonの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap03.html">3. 対話型の実行方法</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. 制御構造と関数・オブジェクト</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#if">4.1. 条件分岐( <code class="docutils literal notranslate"><span class="pre">if</span></code> )</a></li>
<li class="toctree-l2"><a class="reference internal" href="#for">4.2. 反復処理( <code class="docutils literal notranslate"><span class="pre">for</span></code> )</a></li>
<li class="toctree-l2"><a class="reference internal" href="#while">4.3. 反復処理( <code class="docutils literal notranslate"><span class="pre">while</span></code> )</a></li>
<li class="toctree-l2"><a class="reference internal" href="#label-chap04-complexloop">4.4. 複雑な反復処理</a></li>
<li class="toctree-l2"><a class="reference internal" href="#label-chap04-function">4.5. 関数</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">4.5.1. 簡単な例</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">4.5.2. 定義</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">4.5.3. 返値</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">4.5.4. 変数のスコープ</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#label-chap04-object">4.6. オブジェクト</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id15">4.6.1. 属性</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">4.6.2. メソッド</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id17">4.7. 第4章 演習課題</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id18">4.7.1. 課題1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id19">4.7.2. 課題2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id20">4.7.3. 課題3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">4.7.4. 課題4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id22">4.7.5. 課題5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id23">4.7.6. 課題6</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id24">4.7.7. 課題7</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chap05.html">5. 便利な組み込み型</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap06.html">6. NumPy配列の基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap07.html">7. スクリプトとしてのPython</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Python演習</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">4. </span>制御構造と関数・オブジェクト</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1><a class="toc-backref" href="#id31" role="doc-backlink"><span class="section-number">4. </span>制御構造と関数・オブジェクト</a><a class="headerlink" href="#id1" title="Permalink to this heading"></a></h1>
<p>ここでは <code class="docutils literal notranslate"><span class="pre">if</span></code> による条件分岐， <code class="docutils literal notranslate"><span class="pre">for</span></code> や <code class="docutils literal notranslate"><span class="pre">while</span></code> による反復処理，さらには関数の基本的な使い方や，オブジェクトの基本についても学ぼう．</p>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<a href="sample/chap04/sample.html"> サンプルコード </a>
<a href="https://colab.research.google.com/github/amanotk/python-resume-sample/blob/main/chap04/sample.ipynb" target="_blank">
<img src="https://colab.research.google.com/assets/colab-badge.svg" style="vertical-align: text-top;">
</a></div>
<nav class="contents" id="id2">
<p class="topic-title">この章の内容</p>
<ul class="simple">
<li><p><a class="reference internal" href="#id1" id="id31">制御構造と関数・オブジェクト</a></p>
<ul>
<li><p><a class="reference internal" href="#if" id="id32">条件分岐( <code class="docutils literal notranslate"><span class="pre">if</span></code> )</a></p></li>
<li><p><a class="reference internal" href="#for" id="id33">反復処理( <code class="docutils literal notranslate"><span class="pre">for</span></code> )</a></p></li>
<li><p><a class="reference internal" href="#while" id="id34">反復処理( <code class="docutils literal notranslate"><span class="pre">while</span></code> )</a></p></li>
<li><p><a class="reference internal" href="#label-chap04-complexloop" id="id35">複雑な反復処理</a></p></li>
<li><p><a class="reference internal" href="#label-chap04-function" id="id36">関数</a></p></li>
<li><p><a class="reference internal" href="#label-chap04-object" id="id37">オブジェクト</a></p></li>
<li><p><a class="reference internal" href="#id17" id="id38">第4章 演習課題</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="if">
<span id="label-chap04-if"></span><h2><a class="toc-backref" href="#id32" role="doc-backlink"><span class="section-number">4.1. </span>条件分岐( <code class="docutils literal notranslate"><span class="pre">if</span></code> )</a><a class="headerlink" href="#if" title="Permalink to this heading"></a></h2>
<p>Pythonでも基本的な考え方は他の多くのプログラミング言語と同じで，なんらかの値の真偽に応じて処理の流れを分岐する．例えば <code class="docutils literal notranslate"><span class="pre">status</span></code> という変数の真偽に応じて処理を分岐するには</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">status</span> <span class="o">=</span> <span class="kc">True</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ifによる分岐</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">status</span><span class="p">:</span>
<span class="linenos">5</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;status is True&#39;</span><span class="p">)</span>  <span class="c1"># インデントが１段下がる</span>
<span class="linenos">6</span><span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="linenos">7</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;status is False&#39;</span><span class="p">)</span> <span class="c1"># ここも１段下がる</span>
<span class="linenos">8</span><span class="go">status is True</span>
</pre></div>
</div>
<p>のように記述すればよい．ここでインデントが構文ブロックの区切りであったことを思い出して欲しい． <code class="docutils literal notranslate"><span class="pre">if</span></code> に限らず至るところでインデントが必要になるので注意しよう．</p>
<p>なお <code class="docutils literal notranslate"><span class="pre">else</span></code> 節は必要なければ省略することが可能である．CやFortranと異なり，条件式の部分にカッコが必要ないことに注意しよう．（ただしカッコがあっても文法的には誤りではない．）さらに， <code class="docutils literal notranslate"><span class="pre">if</span></code> を入れ子にするなどのより細かい制御の例として以下を見てみよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 入れ子にするなどより細かい制御</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="mi">3</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">a</span><span class="p">:</span>
<span class="linenos"> 7</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a = &#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="gp">... </span>    <span class="c1"># ifを入れ子にする</span>
<span class="linenos"> 9</span><span class="gp">... </span>    <span class="k">if</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">c</span><span class="p">:</span>
<span class="linenos">10</span><span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a + b &gt; c&#39;</span><span class="p">)</span>
<span class="linenos">11</span><span class="gp">... </span>    <span class="k">elif</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">:</span>
<span class="linenos">12</span><span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a + b &lt; c&#39;</span><span class="p">)</span>
<span class="linenos">13</span><span class="gp">... </span>    <span class="k">elif</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">==</span> <span class="n">c</span><span class="p">:</span>
<span class="linenos">14</span><span class="gp">... </span>        <span class="c1"># さらに入れ子にする</span>
<span class="linenos">15</span><span class="gp">... </span>        <span class="k">if</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">16</span><span class="gp">... </span>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a + b = c and c &gt;= 0&#39;</span><span class="p">)</span>
<span class="linenos">17</span><span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">18</span><span class="gp">... </span>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a + b = c and c &lt;  0&#39;</span><span class="p">)</span>
<span class="linenos">19</span><span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos">20</span><span class="gp">... </span>        <span class="c1"># passを使って「何もしない」ことを明示することもできる</span>
<span class="linenos">21</span><span class="gp">... </span>        <span class="k">pass</span>
<span class="linenos">22</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># トップレベルのifに対応するelseは省略</span>
<span class="linenos">23</span><span class="go">a =  1</span>
<span class="linenos">24</span><span class="go">a + b = c and c &gt;= 0</span>
</pre></div>
</div>
<p>なお21行目の <code class="docutils literal notranslate"><span class="pre">pass</span></code> は「何もしない」という意味の文である． <code class="docutils literal notranslate"><span class="pre">else</span></code> 節は省略できるので，わざわざここに <code class="docutils literal notranslate"><span class="pre">pass</span></code> は使う必要はないのだが，場合によっては「何もしない」ことを明示しておくことでプログラムが理解しやすくなることもある．</p>
<p>ここで分岐に使う条件式についてもコメントしておこう．Fortranでは条件式は真偽値(<code class="docutils literal notranslate"><span class="pre">logical</span></code> 型の変数，または <code class="docutils literal notranslate"><span class="pre">.true.</span></code> ， <code class="docutils literal notranslate"><span class="pre">.false.</span></code> のいずれか)に限られていた．それに対して，Pythonの場合はCに近くなっている．すなわち，Python組み込みのbool型である <code class="docutils literal notranslate"><span class="pre">True</span></code> や <code class="docutils literal notranslate"><span class="pre">False</span></code> （これらはPythonの予約済みキーワードで大文字小文字は区別される）だけでなく，任意の型の変数を使うことが出来る．詳細は省くが，とりあえずはCと同様に整数型では <code class="docutils literal notranslate"><span class="pre">0</span></code> が偽とみなされ，それ以外は真とみなされるとおぼえておけばよいだろう．また複雑な条件判定には論理演算子である <code class="docutils literal notranslate"><span class="pre">and</span></code> ， <code class="docutils literal notranslate"><span class="pre">or</span></code> ， <code class="docutils literal notranslate"><span class="pre">not</span></code> を組合わせることになる．以下のテーブルには条件判定によく使われる演算子およびその組み合わせの代表的な例を示す．なお，PythonはCやFortranよりも演算子が多い(例えば <code class="docutils literal notranslate"><span class="pre">is</span></code> 演算子)のだが，ここではそれには触れないことにする．</p>
<table class="docutils align-default" id="id30" style="width: 80%">
<caption><span class="caption-text">論理演算子</span><a class="headerlink" href="#id30" title="このテーブルへのパーマリンク"></a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Python</p></th>
<th class="head"><p>C</p></th>
<th class="head"><p>Fortran</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">B</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;=</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;=</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;=</span> <span class="pre">B</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&lt;</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&lt;</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&lt;</span> <span class="pre">B</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&lt;=</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&lt;=</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&lt;=</span> <span class="pre">B</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">==</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">==</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">==</span> <span class="pre">B</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">!=</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">!=</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">/=</span> <span class="pre">B</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">B</span> <span class="pre">and</span> <span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">C</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">B</span> <span class="pre">&amp;&amp;</span> <span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">C</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">B</span> <span class="pre">.and.</span> <span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">C</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">B</span> <span class="pre">or</span> <span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">C</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">B</span> <span class="pre">||</span> <span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">C</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">B</span> <span class="pre">.or.</span> <span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">C</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">B</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">!</span> <span class="pre">(A</span> <span class="pre">&gt;</span> <span class="pre">B)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.not.</span> <span class="pre">A</span> <span class="pre">&gt;</span> <span class="pre">B</span></code></p></td>
</tr>
</tbody>
</table>
<p>以下は論理演算子を使って様々な条件を組み合わせた例である．演算子の組み合わせにはあらかじめ決められた優先順位に応じて順次評価されるが，カッコで明示的に示したほうが分かりやすい．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span> <span class="ow">and</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">:</span>
<span class="linenos"> 2</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a is smaller than both b and c&#39;</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="go">a is smaller than both b and c</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">:</span>
<span class="linenos"> 6</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a is smaller than either b or c&#39;</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="go">a is smaller than either b or c</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">==</span> <span class="n">c</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
<span class="linenos">10</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;example of complex conditional&#39;</span><span class="p">)</span>
<span class="linenos">11</span><span class="go">example of complex conditional</span>
</pre></div>
</div>
<p>ちなみにPythonにはCの <code class="docutils literal notranslate"><span class="pre">switch</span></code> ，Fortranの <code class="docutils literal notranslate"><span class="pre">select</span></code> に対応する構文は存在しないので， <code class="docutils literal notranslate"><span class="pre">if</span></code> と <code class="docutils literal notranslate"><span class="pre">elif</span></code> で地道に条件判定をつないでいくことになる．</p>
</section>
<section id="for">
<span id="label-chap04-for"></span><h2><a class="toc-backref" href="#id33" role="doc-backlink"><span class="section-number">4.2. </span>反復処理( <code class="docutils literal notranslate"><span class="pre">for</span></code> )</a><a class="headerlink" href="#for" title="Permalink to this heading"></a></h2>
<p>Pythonにおける反復処理（ループ）の最も基本的な形は以下のようなものである．</p>
<p>これを実行すると0, 1, 2, 3, 4が順に出力される．もう少し細かい制御をするのであれば</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="linenos">2</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="linenos">3</span><span class="go">0</span>
<span class="linenos">4</span><span class="go">1</span>
<span class="linenos">5</span><span class="go">2</span>
<span class="linenos">6</span><span class="go">3</span>
<span class="linenos">7</span><span class="go">4</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">increment</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>のようになる．これによって，ループ変数 <code class="docutils literal notranslate"><span class="pre">i</span></code> が <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">start</span></code> から <code class="docutils literal notranslate"><span class="pre">increment</span></code> ずつ変化しながら <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">&lt;</span> <span class="pre">stop</span></code> を満たす限りループの中身が実行さる．ここで <code class="docutils literal notranslate"><span class="pre">start</span></code> ， <code class="docutils literal notranslate"><span class="pre">stop</span></code> ， <code class="docutils literal notranslate"><span class="pre">increment</span></code> は全て整数（または整数型の変数）である必要がある．</p>
<p>これはCなら</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="n">start</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">stop</span><span class="w"> </span><span class="p">;</span><span class="n">increment</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">2</span><span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="linenos">3</span><span class="p">}</span>
</pre></div>
</div>
<p>Fortranなら</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="k">stop</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">increment</span>
<span class="linenos">2</span><span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">i</span>
<span class="linenos">3</span><span class="k">end do</span>
</pre></div>
</div>
<p>に対応する．なお <code class="docutils literal notranslate"><span class="pre">range(5)</span></code> のように1つしか数値を与えなかった場合は，与えられた数値は上記の <code class="docutils literal notranslate"><span class="pre">stop</span></code> と解釈され， <code class="docutils literal notranslate"><span class="pre">start</span> <span class="pre">=</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">increment</span> <span class="pre">=</span> <span class="pre">1</span></code> が指定されたものとみなす．明示的にこれらを指定した例を以下に示しておこう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
<span class="linenos">2</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i     = &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="linenos">3</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i + 1 = &#39;</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">4</span><span class="go">i     =  0</span>
<span class="linenos">5</span><span class="go">i + 1 =  1</span>
<span class="linenos">6</span><span class="go">i     =  2</span>
<span class="linenos">7</span><span class="go">i + 1 =  3</span>
<span class="linenos">8</span><span class="go">i     =  4</span>
<span class="linenos">9</span><span class="go">i + 1 =  5</span>
</pre></div>
</div>
<p>このようにPythonの <code class="docutils literal notranslate"><span class="pre">for</span></code> ループはCのそれと非常に似通っており，またFortranの <code class="docutils literal notranslate"><span class="pre">do</span></code> ループとも細かい違いを除けば同じように使うことが出来るので，まずはこの使い方が理解できていれば問題ない <a class="footnote-reference brackets" href="#id25" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>．</p>
<p>当然ながら，以下のように入れ子にすることで多重ループにすることも可能である．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
<span class="linenos"> 2</span><span class="gp">... </span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
<span class="linenos"> 3</span><span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i = &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;, j = &#39;</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="s1">&#39;, i*j = &#39;</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="linenos"> 4</span><span class="go">i =  1 , j =  1 , i*j =  1</span>
<span class="linenos"> 5</span><span class="go">i =  1 , j =  2 , i*j =  2</span>
<span class="linenos"> 6</span><span class="go">i =  1 , j =  3 , i*j =  3</span>
<span class="linenos"> 7</span><span class="go">i =  1 , j =  4 , i*j =  4</span>
<span class="linenos"> 8</span><span class="go">i =  2 , j =  1 , i*j =  2</span>
<span class="linenos"> 9</span><span class="go">i =  2 , j =  2 , i*j =  4</span>
<span class="linenos">10</span><span class="go">i =  2 , j =  3 , i*j =  6</span>
<span class="linenos">11</span><span class="go">i =  2 , j =  4 , i*j =  8</span>
</pre></div>
</div>
<p>もう少し実用的な例としてテイラー展開の公式を用いて <span class="math notranslate nohighlight">\(\sin(x)\)</span> の近似値を求める例を考えよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*** Taylor expansion of sin(x) ***&#39;</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
<span class="linenos"> 8</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">x</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos">10</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x = &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="linenos">11</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i = &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39; --- sin(x) = &#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="linenos">12</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos">13</span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
<span class="linenos">14</span><span class="gp">... </span>    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span> <span class="o">/</span> <span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="linenos">15</span><span class="gp">... </span>    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">a</span>
<span class="linenos">16</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i = &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39; --- sin(x) = &#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="linenos">17</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos">18</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;exact   --- sin(x) = &#39;</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="linenos">19</span><span class="go">*** Taylor expansion of sin(x) ***</span>
<span class="linenos">20</span><span class="go">x =  0.2</span>
<span class="linenos">21</span><span class="go">i =  1  --- sin(x) =  0.2</span>
<span class="linenos">22</span><span class="go">i =  3  --- sin(x) =  0.19866666666666669</span>
<span class="linenos">23</span><span class="go">i =  5  --- sin(x) =  0.19866933333333336</span>
<span class="linenos">24</span><span class="go">i =  7  --- sin(x) =  0.19866933079365082</span>
<span class="linenos">25</span><span class="go">i =  9  --- sin(x) =  0.19866933079506174</span>
<span class="linenos">26</span><span class="go">exact   --- sin(x) =  0.19866933079506122</span>
</pre></div>
</div>
</section>
<section id="while">
<span id="label-chap04-while"></span><h2><a class="toc-backref" href="#id34" role="doc-backlink"><span class="section-number">4.3. </span>反復処理( <code class="docutils literal notranslate"><span class="pre">while</span></code> )</a><a class="headerlink" href="#while" title="Permalink to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">while</span></code> を使って <code class="docutils literal notranslate"><span class="pre">for</span></code> の場合と同様に0, 1, 2, 3, 4を出力するループは以下のように書くことができる．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
<span class="linenos">3</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="linenos">4</span><span class="gp">... </span>    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="linenos">5</span><span class="go">0</span>
<span class="linenos">6</span><span class="go">1</span>
<span class="linenos">7</span><span class="go">2</span>
<span class="linenos">8</span><span class="go">3</span>
<span class="linenos">9</span><span class="go">4</span>
</pre></div>
</div>
<p>ただし <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">+=</span> <span class="pre">1</span></code> は <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">i</span> <span class="pre">+</span> <span class="pre">1</span></code> と同じ，また <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">-=</span> <span class="pre">1</span></code> であれば <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">i</span> <span class="pre">-</span> <span class="pre">1</span></code> と同じ意味である．これらの文法はCと同じであるがFortranにはない書き方である．（ただしインクリメント演算子 <code class="docutils literal notranslate"><span class="pre">++</span></code> やデクリメント演算子 <code class="docutils literal notranslate"><span class="pre">--</span></code> はPythonには存在しない．）</p>
<p>この例では <code class="docutils literal notranslate"><span class="pre">for</span></code> と基本的に同じ動作をするものであるが， <code class="docutils literal notranslate"><span class="pre">while</span></code> はループの終了判定に任意の条件式を用いることができるため，あらかじめ回数の決まっていないループの実行など，より細かい制御を行うことができる．例えば変数 <code class="docutils literal notranslate"><span class="pre">x</span></code> の値が十分小さくなるまで反復計算をするには</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-10</span><span class="p">:</span>
<span class="linenos">3</span><span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x is not small enough&#39;</span><span class="p">)</span>
<span class="linenos">4</span><span class="gp">... </span>   <span class="c1"># xがゼロに近づくまで何かの計算をする</span>
</pre></div>
</div>
<p>のような処理を行なうことになる．この例もCなら</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos">2</span><span class="k">while</span><span class="p">(</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1.0e-10</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">3</span><span class="w">  </span><span class="c1">// 何かの計算</span>
<span class="linenos">4</span><span class="p">}</span>
</pre></div>
</div>
<p>Fortranなら</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kt">real</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="linenos">2</span><span class="k">do while</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1.0e-10</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">3</span><span class="w">  </span><span class="c">! 何かの計算</span>
<span class="linenos">4</span><span class="k">end do</span>
</pre></div>
</div>
<p>以下はテイラー展開の公式を持ちいて， <span class="math notranslate nohighlight">\(\sin(x)\)</span> の値が組み込み関数で求められる値（真の値）に十分近づくまで反復計算をする例である．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">x</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt; </span><span class="n">ytrue</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i = &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39; --- sin(x) = &#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos">10</span><span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="nb">abs</span><span class="p">((</span><span class="n">ytrue</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">ytrue</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0e-10</span><span class="p">:</span>
<span class="linenos">11</span><span class="gp">... </span>    <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>
<span class="linenos">12</span><span class="gp">... </span>    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span> <span class="o">/</span> <span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="linenos">13</span><span class="gp">... </span>    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">a</span>
<span class="linenos">14</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;i = &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39; --- sin(x) = &#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="linenos">15</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos">16</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;approximated = &#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="linenos">17</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;exact        = &#39;</span><span class="p">,</span> <span class="n">ytrue</span><span class="p">)</span>
<span class="linenos">18</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rel. error   = &#39;</span><span class="p">,</span> <span class="nb">abs</span><span class="p">((</span><span class="n">ytrue</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">ytrue</span><span class="p">))</span>
<span class="linenos">19</span><span class="go">i =  1  --- sin(x) =  0.2</span>
<span class="linenos">20</span><span class="go">i =  3  --- sin(x) =  0.19866666666666669</span>
<span class="linenos">21</span><span class="go">i =  5  --- sin(x) =  0.19866933333333336</span>
<span class="linenos">22</span><span class="go">i =  7  --- sin(x) =  0.19866933079365082</span>
<span class="linenos">23</span><span class="go">approximated =  0.19866933079365082</span>
<span class="linenos">24</span><span class="go">exact        =  0.19866933079506122</span>
<span class="linenos">25</span><span class="go">rel. error   =  7.0992315183418576e-12</span>
</pre></div>
</div>
<p>このような場合は繰り返しの回数が事前には分からないので， <code class="docutils literal notranslate"><span class="pre">for</span></code> を使うよりも <code class="docutils literal notranslate"><span class="pre">while</span></code> を使う方が素直に処理を記述することができる．</p>
</section>
<section id="label-chap04-complexloop">
<span id="id4"></span><h2><a class="toc-backref" href="#id35" role="doc-backlink"><span class="section-number">4.4. </span>複雑な反復処理</a><a class="headerlink" href="#label-chap04-complexloop" title="Permalink to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">for</span></code> ， <code class="docutils literal notranslate"><span class="pre">while</span></code> のいずれも <code class="docutils literal notranslate"><span class="pre">continue</span></code> や <code class="docutils literal notranslate"><span class="pre">break</span></code> で，より細かいループの制御を行なうことができる <a class="footnote-reference brackets" href="#id26" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>．使い方はCのそれと同じである．Fortranでは <code class="docutils literal notranslate"><span class="pre">continue</span></code> は <code class="docutils literal notranslate"><span class="pre">cycle</span></code> ， <code class="docutils literal notranslate"><span class="pre">break</span></code> は <code class="docutils literal notranslate"><span class="pre">exit</span></code> と同じ意味である．</p>
<p>以下の例は <code class="docutils literal notranslate"><span class="pre">condition1</span></code> が満たされたときに「処理1」を， <code class="docutils literal notranslate"><span class="pre">condition2</span></code> が満たされたときに「処理2」を，どちらも満たされなかったときには「処理3」を実行する．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="k">if</span>   <span class="n">condition1</span><span class="p">:</span>
<span class="linenos">3</span>        <span class="c1"># 処理1</span>
<span class="linenos">4</span>        <span class="k">break</span>
<span class="linenos">5</span>    <span class="k">elif</span> <span class="n">condition2</span><span class="p">:</span>
<span class="linenos">6</span>        <span class="c1"># 処理2</span>
<span class="linenos">7</span>        <span class="k">continue</span>
<span class="linenos">8</span>    <span class="c1"># 処理3</span>
</pre></div>
</div>
<p>以下の例は <code class="docutils literal notranslate"><span class="pre">while</span></code> ループで <code class="docutils literal notranslate"><span class="pre">continue</span></code> や <code class="docutils literal notranslate"><span class="pre">break</span></code> を使う例である．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="linenos"> 3</span><span class="gp">... </span>    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="linenos"> 4</span><span class="gp">... </span>    <span class="k">if</span>   <span class="n">i</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 5</span><span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Multiple of 2 --- &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="gp">... </span>        <span class="k">continue</span>
<span class="linenos"> 7</span><span class="gp">... </span>    <span class="k">elif</span> <span class="n">i</span><span class="o">%</span><span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 8</span><span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Multiple of 3 --- &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="gp">... </span>        <span class="k">continue</span>
<span class="linenos">10</span><span class="gp">... </span>    <span class="k">elif</span> <span class="n">i</span><span class="o">%</span><span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">11</span><span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Multiple of 5 --- &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="linenos">12</span><span class="gp">... </span>        <span class="k">continue</span>
<span class="linenos">13</span><span class="gp">... </span>    <span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
<span class="linenos">14</span><span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exit&#39;</span><span class="p">)</span>
<span class="linenos">15</span><span class="gp">... </span>        <span class="k">break</span>
<span class="linenos">16</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Not a multiple of 2, 3, 5 --- &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="linenos">17</span><span class="go">Multiple of 2 ---  2</span>
<span class="linenos">18</span><span class="go">Multiple of 3 ---  3</span>
<span class="linenos">19</span><span class="go">Multiple of 2 ---  4</span>
<span class="linenos">20</span><span class="go">Multiple of 5 ---  5</span>
<span class="linenos">21</span><span class="go">Multiple of 2 ---  6</span>
<span class="linenos">22</span><span class="go">Not a multiple of 2, 3, 5 ---  7</span>
<span class="linenos">23</span><span class="go">Multiple of 2 ---  8</span>
<span class="linenos">24</span><span class="go">Multiple of 3 ---  9</span>
<span class="linenos">25</span><span class="go">Multiple of 2 ---  10</span>
<span class="linenos">26</span><span class="go">Exit</span>
</pre></div>
</div>
</section>
<section id="label-chap04-function">
<span id="id6"></span><h2><a class="toc-backref" href="#id36" role="doc-backlink"><span class="section-number">4.5. </span>関数</a><a class="headerlink" href="#label-chap04-function" title="Permalink to this heading"></a></h2>
<p>複雑でまとまった処理を関数としてあらかじめ定義しておくことで，それを様々な場所から呼び出して使うことができて便利である．関数の詳細にはは触れずに，まずは最も基本的な使い方だけを身につけよう．</p>
<section id="id7">
<h3><span class="section-number">4.5.1. </span>簡単な例<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h3>
<p>まずは以下の例を見てみよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 関数定義</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="linenos">3</span><span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 関数呼び出し</span>
<span class="linenos">6</span><span class="gp">&gt;&gt;&gt; </span><span class="n">square</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="linenos">7</span><span class="go">4.0</span>
</pre></div>
</div>
<p>ここで2-3行目が関数の定義である．ここでは与えられた引数の2乗を計算し，その値を返す <code class="docutils literal notranslate"><span class="pre">square</span></code> という関数を定義している．6行目がこの関数の呼び出しであり，引数の2乗を計算した値が返ってきたのが分かる．</p>
</section>
<section id="id8">
<h3><span class="section-number">4.5.2. </span>定義<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h3>
<p>Pythonにおける関数定義は以下のように <code class="docutils literal notranslate"><span class="pre">def</span></code> を用いて行えばよい．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">関数名</span><span class="p">(</span><span class="n">引数1</span><span class="p">,</span> <span class="n">引数2</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="n">関数内の処理</span><span class="p">(</span><span class="n">インデントに注意</span><span class="p">)</span>
</pre></div>
</div>
<p>ここでもインデントによって関数定義ブロックとそれ以外を区別していることに注意しよう． <code class="docutils literal notranslate"><span class="pre">def</span></code> の次の行のインデントが終わるまでが関数定義とみなされる．先ほどの例 <code class="docutils literal notranslate"><span class="pre">square</span></code> では引数は一つであったが，複数の場合はカンマ <code class="docutils literal notranslate"><span class="pre">,</span></code> で区切って並べればよい．これらが関数への入力となる <a class="footnote-reference brackets" href="#id27" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>．</p>
<p>関数の定義位置には注意が必要である．Pythonはコンパイル型の言語ではないため，上から順に実行され，実行時に各行が評価される．したがって， <strong>関数定義は呼び出しよりも必ず前にされていなければならない</strong> のである．ただし，これはあくまで実行時の順序であってソースコード上での位置(行数)を意味するものではない．以下の例を見てみよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 以下の呼び出しはエラー(この時点ではhelloは定義されていない)</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#hello1()</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">hello2</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="linenos"> 5</span><span class="gp">... </span>    <span class="n">hello1</span><span class="p">()</span> <span class="c1"># 実行時にhello1が定義済みであればOK</span>
<span class="linenos"> 6</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;I am&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos"> 8</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 以下の呼び出しもエラー(この時点ではhello2が呼び出すhello1は定義されていない)</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#hello2(&#39;John&#39;)</span>
<span class="linenos">10</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos">11</span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">hello1</span><span class="p">():</span>
<span class="linenos">12</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="linenos">13</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos">14</span><span class="gp">&gt;&gt;&gt; </span><span class="n">hello1</span><span class="p">()</span>
<span class="linenos">15</span><span class="gp">&gt;&gt;&gt; </span><span class="n">hello2</span><span class="p">(</span><span class="s1">&#39;John&#39;</span><span class="p">)</span>
<span class="linenos">16</span><span class="go">Hello</span>
<span class="linenos">17</span><span class="go">Hello</span>
<span class="linenos">18</span><span class="go">I am John</span>
</pre></div>
</div>
<p>コメントアウトされている2行目の <code class="docutils literal notranslate"><span class="pre">hello1</span></code> ，9行目の <code class="docutils literal notranslate"><span class="pre">hello2</span></code> の呼び出しはどちらもれエラーとなる．2行目は，この時点で <code class="docutils literal notranslate"><span class="pre">hello1</span></code> が定義されていないので明らかである．一方で9行目については，この時点で <code class="docutils literal notranslate"><span class="pre">hello2</span></code> が定義されているので一見問題ないように見えるが， <code class="docutils literal notranslate"><span class="pre">hello2</span></code> の内部(5行目)で呼び出される <code class="docutils literal notranslate"><span class="pre">hello1</span></code> がまだ定義されていないのでエラーになるのである．これはJupyter Notebookを常用しているとセルの評価順序がバラバラになってしまうので曖昧になりやすい点なので注意しておこう．</p>
</section>
<section id="id10">
<h3><span class="section-number">4.5.3. </span>返値<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h3>
<p>関数から呼び出し元に制御を戻すときには <code class="docutils literal notranslate"><span class="pre">return</span></code> を用いる． <code class="docutils literal notranslate"><span class="pre">return</span></code> には関数の返値を指定することもできるが，省略することもできる．このときはデフォルトで <code class="docutils literal notranslate"><span class="pre">None</span></code> を返す <a class="footnote-reference brackets" href="#id28" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>．なお， <code class="docutils literal notranslate"><span class="pre">return</span></code> がなくても関数定義ブロックの最後まで到達したときには呼び出し元に制御が戻り， <code class="docutils literal notranslate"><span class="pre">None</span></code> が返値となる．Fortranでは関数とサブルーチンが区別されているが，Pythonではサブルーチンは存在せず， <code class="docutils literal notranslate"><span class="pre">None</span></code> を返す関数がFortranのサブルーチンに相当すると考えておけばよいだろう．</p>
</section>
<section id="id12">
<h3><span class="section-number">4.5.4. </span>変数のスコープ<a class="headerlink" href="#id12" title="Permalink to this heading"></a></h3>
<p>関数の中では自由に変数を定義して使うことができる．例えば以下の例をみてみよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># approximation of exp(x) via taylor expansion up to order n</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">exp_taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="linenos"> 5</span><span class="gp">... </span>    <span class="n">c</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 6</span><span class="gp">... </span>    <span class="n">f</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 7</span><span class="gp">... </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="linenos"> 8</span><span class="gp">... </span>        <span class="n">c</span> <span class="o">/=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="gp">... </span>        <span class="n">f</span> <span class="o">+=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">10</span><span class="gp">... </span>    <span class="k">return</span> <span class="n">f</span>
<span class="linenos">11</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos">12</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--- exp_taylor ---&#39;</span><span class="p">)</span>
<span class="linenos">13</span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="linenos">14</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x     = &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="linenos">15</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1st   = &#39;</span><span class="p">,</span> <span class="n">exp_taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="linenos">16</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2nd   = &#39;</span><span class="p">,</span> <span class="n">exp_taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="linenos">17</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;3rd   = &#39;</span><span class="p">,</span> <span class="n">exp_taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="linenos">18</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;4th   = &#39;</span><span class="p">,</span> <span class="n">exp_taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="linenos">19</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;5th   = &#39;</span><span class="p">,</span> <span class="n">exp_taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="linenos">20</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;6th   = &#39;</span><span class="p">,</span> <span class="n">exp_taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="linenos">21</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;7th   = &#39;</span><span class="p">,</span> <span class="n">exp_taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="linenos">22</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;8th   = &#39;</span><span class="p">,</span> <span class="n">exp_taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="linenos">23</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;exact = &#39;</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="linenos">24</span><span class="go">--- exp_taylor ---</span>
<span class="linenos">25</span><span class="go">x     =  0.5</span>
<span class="linenos">26</span><span class="go">1st   =  1.5</span>
<span class="linenos">27</span><span class="go">2nd   =  1.625</span>
<span class="linenos">28</span><span class="go">3rd   =  1.6458333333333333</span>
<span class="linenos">29</span><span class="go">4th   =  1.6484375</span>
<span class="linenos">30</span><span class="go">5th   =  1.6486979166666667</span>
<span class="linenos">31</span><span class="go">6th   =  1.6487196180555554</span>
<span class="linenos">32</span><span class="go">7th   =  1.6487211681547618</span>
<span class="linenos">33</span><span class="go">8th   =  1.6487212650359622</span>
<span class="linenos">34</span><span class="go">exact =  1.6487212707001282</span>
</pre></div>
</div>
<p>この関数 <code class="docutils literal notranslate"><span class="pre">exp_taylor</span></code> はテイラー展開の公式を <code class="docutils literal notranslate"><span class="pre">n</span></code> 次まで用いて <code class="docutils literal notranslate"><span class="pre">exp(x)</span></code> の近似値を求める．ここで5行目や6行目のように変数を定義して用いている．これらの変数はローカル変数と呼ばれ，この関数の内部でのみ有効な変数である．すなわちこの関数の外で <code class="docutils literal notranslate"><span class="pre">c</span></code> や <code class="docutils literal notranslate"><span class="pre">f</span></code> という変数は(これとは別に定義しない限り)定義されない．もし関数の外で同じ名前の変数を定義して用いたとしても，それらはこの関数内の変数とは全く無関係である．</p>
<p>一方で，関数の外で定義された変数に関数内からアクセスしたいこともあるかもしれない．例えば，以下の関数 <code class="docutils literal notranslate"><span class="pre">fibonacci</span></code> は呼ばれるたびにフィボナッチ数列を返す関数である．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># global variables for fibonacci</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=-</span><span class="mi">1</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">fibonacci</span><span class="p">():</span>
<span class="linenos"> 6</span><span class="gp">... </span>    <span class="c1"># a and b refer to the global variables</span>
<span class="linenos"> 7</span><span class="gp">... </span>    <span class="k">global</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
<span class="linenos"> 8</span><span class="gp">... </span>    <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="linenos"> 9</span><span class="gp">... </span>    <span class="n">a</span> <span class="o">=</span> <span class="n">b</span>
<span class="linenos">10</span><span class="gp">... </span>    <span class="n">b</span> <span class="o">=</span> <span class="n">c</span>
<span class="linenos">11</span><span class="gp">... </span>    <span class="k">return</span> <span class="n">c</span>
<span class="linenos">12</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos">13</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--- fibonacci ---&#39;</span><span class="p">)</span>
<span class="linenos">14</span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
<span class="linenos">15</span><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">fibonacci</span><span class="p">())</span>
<span class="linenos">16</span><span class="go">--- fibonacci ---</span>
<span class="linenos">17</span><span class="go">0</span>
<span class="linenos">18</span><span class="go">1</span>
<span class="linenos">19</span><span class="go">1</span>
<span class="linenos">20</span><span class="go">2</span>
<span class="linenos">21</span><span class="go">3</span>
<span class="linenos">22</span><span class="go">5</span>
<span class="linenos">23</span><span class="go">8</span>
<span class="linenos">24</span><span class="go">13</span>
<span class="linenos">25</span><span class="go">21</span>
<span class="linenos">26</span><span class="go">34</span>
<span class="linenos">27</span><span class="go">55</span>
<span class="linenos">28</span><span class="go">89</span>
<span class="linenos">29</span><span class="go">144</span>
<span class="linenos">30</span><span class="go">233</span>
<span class="linenos">31</span><span class="go">377</span>
<span class="linenos">32</span><span class="go">610</span>
<span class="linenos">33</span><span class="go">987</span>
<span class="linenos">34</span><span class="go">1597</span>
<span class="linenos">35</span><span class="go">2584</span>
<span class="linenos">36</span><span class="go">4181</span>
</pre></div>
</div>
<p>ここでは <code class="docutils literal notranslate"><span class="pre">a</span></code> ， <code class="docutils literal notranslate"><span class="pre">b</span></code> という変数は関数の外(トップレベル)で定義された変数であり，これらに以前の数列の値を保持している．このような変数をグローバル変数と呼ぶ．関数 <code class="docutils literal notranslate"><span class="pre">fibonacci</span></code> からこれらの変数にアクセスするには22行目のように <code class="docutils literal notranslate"><span class="pre">global</span></code> を用いて，グローバル変数を用いることを明示する．この例では <code class="docutils literal notranslate"><span class="pre">a</span></code> および <code class="docutils literal notranslate"><span class="pre">b</span></code> は関数内で値が更新されているが，これによってグローバル変数の値も更新される．</p>
<p>このように関数内では基本的に関数内部でのみ有効なローカル変数を用い，グローバル変数へのアクセスが必要なときのみ，それを <code class="docutils literal notranslate"><span class="pre">global</span></code> によって明示すればよい <a class="footnote-reference brackets" href="#id29" id="id13" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>．ただし，グローバル変数は気をつけて使わないとバグの原因となりやすいため推奨できない．引数を使って明示的に値を渡すか，場合によってはクラスを用いて実装する方がよいことが多い．</p>
</section>
</section>
<section id="label-chap04-object">
<span id="id14"></span><h2><a class="toc-backref" href="#id37" role="doc-backlink"><span class="section-number">4.6. </span>オブジェクト</a><a class="headerlink" href="#label-chap04-object" title="Permalink to this heading"></a></h2>
<p>ここまではあえて曖昧にしてきたが，実はPythonでは全て(変数，関数，モジュールなど)がオブジェクト(正確には組み込みの <code class="docutils literal notranslate"><span class="pre">object</span></code> クラスのインスタンス)である．このことを正確に理解するにはオブジェクト指向の考え方が必要になるので，ここでは詳細には立ち入らない．Pythonはオブジェクト指向についての知識がなくても「なんとなく」使えるという意味で簡単な言語であるが，本格的に使うには，オブジェクト指向やクラス，インスタンス，イテレータなどの少々難解な概念を理解する必要が出てくる．そういう意味ではPythonを本当に使いこなすのは少し難しいかもしれない．Pythonのいいところは初心者でもある程度簡単に使えるのに加えて，上級者には強力な機能を提供しているところと言えるかもしれない．ここではPythonを使うにあたって必要最低限の知識だけを身につけておこう．</p>
<section id="id15">
<h3><span class="section-number">4.6.1. </span>属性<a class="headerlink" href="#id15" title="Permalink to this heading"></a></h3>
<p>一般にオブジェクトは属性(attribute)と呼ばれるオブジェクトに紐付けられた変数を持つ．例えば「人間」には「名前」という属性があるし，「学生」には「学生証番号」という属性がある，といった具合にそれぞれのオブジェクトの実体が固有の変数を持っていると考えればよい．</p>
<p>オブジェクトに紐付けられた属性にアクセスするには <code class="docutils literal notranslate"><span class="pre">.</span></code> を用いる．例えば <code class="docutils literal notranslate"><span class="pre">sys</span></code> というモジュールもオブジェクトなので，いくつかの属性を持っている．以下の例を見てみよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sys</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">version</span>
<span class="linenos">3</span><span class="go">&#39;3.7.10 (default, Feb 26 2021, 18:47:35) \n[GCC 7.3.0]&#39;</span>
</pre></div>
</div>
<p>ここでは <code class="docutils literal notranslate"><span class="pre">sys.version</span></code> で <code class="docutils literal notranslate"><span class="pre">sys</span></code> オブジェクトの <code class="docutils literal notranslate"><span class="pre">version</span></code> という属性にアクセスしている．属性は普通の変数と全く同じように用いることができる．</p>
</section>
<section id="id16">
<h3><span class="section-number">4.6.2. </span>メソッド<a class="headerlink" href="#id16" title="Permalink to this heading"></a></h3>
<p>属性が変数であったのに対して，メソッド(method)はオブジェクトに紐付けられた関数と考えればよい．例えば「人間」には「走る」という動作があり，「学生」には「学校に行く」という動作がある．メソッドはこのようなオブジェクトの動きを表すものと考えるとよい．ただし，必ずしもオブジェクトの動きを表すようなメソッドでなくてもよく，単にオブジェクトに紐付けられた関数と考えることも多い．</p>
<p>例えばPythonプログラムを終了するには <code class="docutils literal notranslate"><span class="pre">sys.exit()</span></code> 関数を使うことは <a class="reference internal" href="chap02.html"><span class="doc">Pythonの基本</span></a> で見た通りであるが，これは <code class="docutils literal notranslate"><span class="pre">sys</span></code> オブジェクトの <code class="docutils literal notranslate"><span class="pre">exit()</span></code> メソッドを呼び出していると考えればよい．他の例も見てみよう．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;python&#39;</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="linenos">3</span><span class="go">&#39;PYTHON&#39;</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="linenos">5</span><span class="go">&#39;python&#39;</span>
<span class="linenos">6</span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
<span class="linenos">7</span><span class="go">&#39;Python&#39;</span>
</pre></div>
</div>
<p>この例では文字列 <code class="docutils literal notranslate"><span class="pre">s</span></code> の メソッド <code class="docutils literal notranslate"><span class="pre">upper()</span></code> ， <code class="docutils literal notranslate"><span class="pre">lower()</span></code> ， <code class="docutils literal notranslate"><span class="pre">capitalize()</span></code> をそれぞれ呼び出している．その名前と実行結果から明らかなように，それぞれ大文字に変換，小文字に変換，先頭だけ大文字で以降は小文字に変換した文字列を返す関数である．</p>
</section>
</section>
<section id="id17">
<h2><a class="toc-backref" href="#id38" role="doc-backlink"><span class="section-number">4.7. </span>第4章 演習課題</a><a class="headerlink" href="#id17" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>以下の課題はJupyter Notebookの使用を前提としているが，もちろん他の実行環境でも同等の処理を実現出来ていれば問題ない．</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参考</p>
<a href="answer/chap04/kadai.html"> 解答例 </a>
<a href="https://colab.research.google.com/github/amanotk/python-resume-answer/blob/main/chap04/kadai.ipynb" target="_blank">
<img src="https://colab.research.google.com/assets/colab-badge.svg" style="vertical-align: text-top;">
</a></div>
<section id="id18">
<h3><span class="section-number">4.7.1. </span>課題1<a class="headerlink" href="#id18" title="Permalink to this heading"></a></h3>
<p>サンプルを実行して動作を確認しよう．</p>
</section>
<section id="id19">
<h3><span class="section-number">4.7.2. </span>課題2<a class="headerlink" href="#id19" title="Permalink to this heading"></a></h3>
<p>2つの整数 <code class="docutils literal notranslate"><span class="pre">m</span></code> および <code class="docutils literal notranslate"><span class="pre">n</span></code> を引数として受け取り，その大小を比較する関数 <code class="docutils literal notranslate"><span class="pre">compare</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">compare</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;mとnを比較する&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．これを呼び出すと</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">compare</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="linenos">2</span><span class="go">2 is larger than 1</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">compare</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="linenos">4</span><span class="go">1 is smaller than 2</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="n">compare</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="linenos">6</span><span class="go">3 is equal to 3</span>
</pre></div>
</div>
<p>などと出力するようにすること．</p>
</section>
<section id="id20">
<h3><span class="section-number">4.7.3. </span>課題3<a class="headerlink" href="#id20" title="Permalink to this heading"></a></h3>
<p>西暦(整数)を引数として受け取り，うるう年かどうか判定する関数 <code class="docutils literal notranslate"><span class="pre">is_leapyear</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">is_leapyear</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;うるう年の判定&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．引数がうるう年であれば真( <code class="docutils literal notranslate"><span class="pre">True</span></code> )，そうでなければ偽( <code class="docutils literal notranslate"><span class="pre">False</span></code> )を返すものとする．ただしうるう年の判定条件は以下の通りである．</p>
<blockquote>
<div><ul class="simple">
<li><p>400で割り切れる年は無条件でうるう年である．</p></li>
<li><p>400で割り切れずに100で割り切れる年はうるう年ではない．</p></li>
<li><p>100で割り切れずに4で割り切れる年はうるう年である．</p></li>
</ul>
</div></blockquote>
<p>以下はこの関数の呼び出しの例である．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">is_leapyear</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="linenos">2</span><span class="go">True</span>
</pre></div>
</div>
</section>
<section id="id21">
<h3><span class="section-number">4.7.4. </span>課題4<a class="headerlink" href="#id21" title="Permalink to this heading"></a></h3>
<p>整数 <code class="docutils literal notranslate"><span class="pre">N</span></code> を引数として受け取り， <span class="math notranslate nohighlight">\(0^{\circ} \leq \theta \leq 180^{\circ}\)</span> をN分割した点(端点を含むのでN+1点)，およびそれらの点における <span class="math notranslate nohighlight">\(\sin \theta\)</span> ， <span class="math notranslate nohighlight">\(\cos \theta\)</span> の値を出力する関数</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">trigonometric</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;θ, sinθ, cosθの値を出力する&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成せよ．これを呼び出すと例えば以下のような出力が得られるものとする．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">trigonometric</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="go">  +0.000e+00   +0.000e+00   +1.000e+00</span>
<span class="linenos"> 3</span><span class="go">  +1.000e+01   +1.736e-01   +9.848e-01</span>
<span class="linenos"> 4</span><span class="go">  +2.000e+01   +3.420e-01   +9.397e-01</span>
<span class="linenos"> 5</span><span class="go">  +3.000e+01   +5.000e-01   +8.660e-01</span>
<span class="linenos"> 6</span><span class="go">  +4.000e+01   +6.428e-01   +7.660e-01</span>
<span class="linenos"> 7</span><span class="go">  +5.000e+01   +7.660e-01   +6.428e-01</span>
<span class="linenos"> 8</span><span class="go">  +6.000e+01   +8.660e-01   +5.000e-01</span>
<span class="linenos"> 9</span><span class="go">  +7.000e+01   +9.397e-01   +3.420e-01</span>
<span class="linenos">10</span><span class="go">  +8.000e+01   +9.848e-01   +1.736e-01</span>
<span class="linenos">11</span><span class="go">  +9.000e+01   +1.000e+00   +6.123e-17</span>
<span class="linenos">12</span><span class="go">  +1.000e+02   +9.848e-01   -1.736e-01</span>
<span class="linenos">13</span><span class="go">  +1.100e+02   +9.397e-01   -3.420e-01</span>
<span class="linenos">14</span><span class="go">  +1.200e+02   +8.660e-01   -5.000e-01</span>
<span class="linenos">15</span><span class="go">  +1.300e+02   +7.660e-01   -6.428e-01</span>
<span class="linenos">16</span><span class="go">  +1.400e+02   +6.428e-01   -7.660e-01</span>
<span class="linenos">17</span><span class="go">  +1.500e+02   +5.000e-01   -8.660e-01</span>
<span class="linenos">18</span><span class="go">  +1.600e+02   +3.420e-01   -9.397e-01</span>
<span class="linenos">19</span><span class="go">  +1.700e+02   +1.736e-01   -9.848e-01</span>
<span class="linenos">20</span><span class="go">  +1.800e+02   +1.225e-16   -1.000e+00</span>
</pre></div>
</div>
<p>ここで三角関数 ( <code class="docutils literal notranslate"><span class="pre">math.sin</span></code> および <code class="docutils literal notranslate"><span class="pre">math.cos</span></code> )の引数はラジアン単位であることに注意しよう．なお，上の例では出力のフォーマットは</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># xはθ，y1, y2はsinθ，cosθの値</span>
<span class="linenos">2</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:+12.3e}</span><span class="s1"> </span><span class="si">{:+12.3e}</span><span class="s1"> </span><span class="si">{:+12.3e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
</pre></div>
</div>
<p>としている．</p>
</section>
<section id="id22">
<h3><span class="section-number">4.7.5. </span>課題5<a class="headerlink" href="#id22" title="Permalink to this heading"></a></h3>
<p>引数として与えられた2つの整数 <code class="docutils literal notranslate"><span class="pre">m</span></code> および <code class="docutils literal notranslate"><span class="pre">n</span></code> の最大公約数を求める関数 <code class="docutils literal notranslate"><span class="pre">gcd</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;mとnの最大公倍数を求める&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成せよ．これを呼び出すと例えば以下のような出力が得られるものとする．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">gcd</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="linenos">2</span><span class="go">4</span>
</pre></div>
</div>
<p>なお，最大公約数を求めるには以下のアルゴリズム(ユークリッドの互除法)を用いるとよい．(以下では <span class="math notranslate nohighlight">\(m &gt; n\)</span> を仮定していることに注意しよう)</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(m\)</span> を <span class="math notranslate nohighlight">\(n\)</span> で割った余り <span class="math notranslate nohighlight">\(r\)</span> を求める．</p></li>
<li><p>もし <span class="math notranslate nohighlight">\(r = 0\)</span> ならば <span class="math notranslate nohighlight">\(n\)</span> が最大公約数である．</p></li>
<li><p>もし <span class="math notranslate nohighlight">\(r \neq 0\)</span> ならば， <span class="math notranslate nohighlight">\(m\)</span> に <span class="math notranslate nohighlight">\(n\)</span> を， <span class="math notranslate nohighlight">\(n\)</span> に <span class="math notranslate nohighlight">\(r\)</span> を代入して[1]に戻る(繰り返す)．</p></li>
</ol>
</div></blockquote>
</section>
<section id="id23">
<h3><span class="section-number">4.7.6. </span>課題6<a class="headerlink" href="#id23" title="Permalink to this heading"></a></h3>
<p>以下の級数展開</p>
<div class="math notranslate nohighlight">
\[e \simeq \sum_{n=0}^{N} \frac{1}{n !}. \quad (0! = 1に注意せよ)\]</div>
<p>により自然対数の底 <span class="math notranslate nohighlight">\(e\)</span> の近似値を求める関数 <code class="docutils literal notranslate"><span class="pre">approx_e</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">approx_e</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;自然対数の底を級数展開を用いて求める&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．ただし整数 <code class="docutils literal notranslate"><span class="pre">N</span></code> および 実数 <code class="docutils literal notranslate"><span class="pre">epsilon</span></code> を引数として受け取り，関数の返値としては，収束ステータス(収束すれば <code class="docutils literal notranslate"><span class="pre">True</span></code> そうでなければ <code class="docutils literal notranslate"><span class="pre">False</span></code> )，反復回数，最終的な近似値の3つを返すこと．</p>
<p>ただし以下の条件を満たすこと．</p>
<blockquote>
<div><ul class="simple">
<li><p>N &gt; 1 でない，または 0 &lt; epsilon &lt; 1 でない場合にはエラーメッセージを表示して，収束ステータス，反復回数，近似値の全てを <code class="docutils literal notranslate"><span class="pre">None</span></code> とすること．</p></li>
<li><p>誤差がepsilon以下になった時点か， n = Nまで計算した時点で級数計算を打ち切る．</p></li>
</ul>
</div></blockquote>
<p>以下はこの関数を呼び出し，結果を表示する例である．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">status</span><span class="p">,</span> <span class="n">iteration</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">approx_e</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">1.0e-8</span><span class="p">)</span>
<span class="linenos"> 2</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos"> 3</span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">status</span><span class="p">:</span>
<span class="linenos"> 4</span><span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Converged !&#39;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>
<span class="linenos"> 6</span><span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Did not converge !&#39;</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos"> 8</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&gt;20}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">iteration</span><span class="p">))</span>
<span class="linenos"> 9</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&gt;20.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Approximated&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
<span class="linenos">10</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&gt;20.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Exact&#39;</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">e</span><span class="p">))</span>
<span class="linenos">11</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&gt;20.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">e</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">e</span><span class="p">)</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">e</span><span class="p">))</span>
<span class="linenos">12</span><span class="go">Did not converge !</span>
<span class="linenos">13</span><span class="go">N                    :                   10</span>
<span class="linenos">14</span><span class="go">Approximated         : 2.71828180114638e+00</span>
<span class="linenos">15</span><span class="go">Exact                : 2.71828182845905e+00</span>
<span class="linenos">16</span><span class="go">Error                : 1.00477663102111e-08</span>
</pre></div>
</div>
</section>
<section id="id24">
<h3><span class="section-number">4.7.7. </span>課題7<a class="headerlink" href="#id24" title="Permalink to this heading"></a></h3>
<p>与えられた実数 <span class="math notranslate nohighlight">\(a (&gt; 0)\)</span> の平方根の近似値を以下のような逐次近似</p>
<div class="math notranslate nohighlight">
\[x_{n+1} = \frac{1}{2} \left( \frac{a}{x_{n}} + x_{n} \right)\]</div>
<p>で計算して返す関数 <code class="docutils literal notranslate"><span class="pre">approx_sqrt</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">def</span> <span class="nf">approx_sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">):</span>
<span class="linenos">2</span>    <span class="s2">&quot;aの平方根の近似値を求める&quot;</span>
<span class="linenos">3</span>    <span class="k">pass</span>
</pre></div>
</div>
<p>を作成しよう．ここで <code class="docutils literal notranslate"><span class="pre">epsilon</span></code> は許容誤差である．</p>
<p>なお， <span class="math notranslate nohighlight">\(x_{n}\)</span> は <span class="math notranslate nohighlight">\(\sqrt{a}\)</span> の <span class="math notranslate nohighlight">\(n\)</span> 番目の近似値である．初期値としては <span class="math notranslate nohighlight">\(x_{0} = a\)</span> を与え，<span class="math notranslate nohighlight">\(\|x_{n+1} - x_{n}\| &lt; \epsilon \|x_{n}\|\)</span> を満たすまで反復を繰り返せばよい．</p>
<p>以下はこの関数を呼び出し，結果を表示する例である．</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">sqrta1</span> <span class="o">=</span> <span class="n">approx_sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0e-5</span><span class="p">)</span>
<span class="linenos">2</span><span class="gp">&gt;&gt;&gt; </span><span class="n">sqrta2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="linenos">3</span><span class="gp">&gt;&gt;&gt;</span>
<span class="linenos">4</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&gt;20.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Approximated&#39;</span><span class="p">,</span> <span class="n">sqrta1</span><span class="p">))</span>
<span class="linenos">5</span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20}</span><span class="s1"> : </span><span class="si">{:&gt;20.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Exact&#39;</span><span class="p">,</span> <span class="n">sqrta2</span><span class="p">))</span>
<span class="linenos">6</span><span class="go">Approximated         : 1.41421356237469e+00</span>
<span class="linenos">7</span><span class="go">Exact                : 1.41421356237310e+00</span>
</pre></div>
</div>
<hr class="docutils" />
<aside class="footnote brackets" id="id25" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">1</a><span class="fn-bracket">]</span></span>
<p>巷で出くわすPythonのループは例えば</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
<span class="linenos">4</span>    <span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>のように複雑怪奇なものが多いことに気がつくであろう．これはイテレータなるものを使って反復処理をもう少し一般的にしたものである．これは少しばかり高度な話題なのでまずは置いておくことにしよう．</p>
</aside>
<aside class="footnote brackets" id="id26" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">2</a><span class="fn-bracket">]</span></span>
<p><code class="docutils literal notranslate"><span class="pre">else</span></code> 節という構文もあるが，それほど重要ではないのでここでは省略する．</p>
</aside>
<aside class="footnote brackets" id="id27" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">3</a><span class="fn-bracket">]</span></span>
<p>引数を入力だけでなく出力として用いることも可能である．しかしこれには少し複雑な事情があるので，ここでは最も基本的な使い方である引数を入力とし返値を出力とする使い方をまずは覚えておこう．</p>
</aside>
<aside class="footnote brackets" id="id28" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id11">4</a><span class="fn-bracket">]</span></span>
<p>これは「何でもない」ということを示すPythonに組み込みのオブジェクトである</p>
</aside>
<aside class="footnote brackets" id="id29" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id13">5</a><span class="fn-bracket">]</span></span>
<p>厳密に言うともう少し複雑な振る舞いをするのだが，グローバル変数を使う際には明示的に <code class="docutils literal notranslate"><span class="pre">global</span></code> を付けておいた方が可読性の観点からよいので，このような記述にとどめた．</p>
</aside>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="chap03.html" class="btn btn-neutral float-left" title="3. 対話型の実行方法" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="chap05.html" class="btn btn-neutral float-right" title="5. 便利な組み込み型" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Takanobu Amano.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>